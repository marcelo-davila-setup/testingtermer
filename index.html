<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adriana Sousa - Desbloqueie Sua Mente + Experiência Impossível</title>
    
    <!-- PERFORMANCE OPTIMIZATION -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://ipinfo.io">
    <link rel="preconnect" href="https://get.geojs.io">
    <link rel="preload" as="script" href="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js">
    
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand:wght@400&family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- THREE.JS para mapas 3D -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 20px;
        }
        
        :root {
            /* === CORES ORIGINAIS ADRIANA === */
            --bg: #F8F5F0;
            --text: #33353A;
            --accent: #D4AF37;
            --dark: #1A2035;
            --white: #ffffff;
            --red: #dc2626;
            --success: #10b981;
            
            /* === GRADIENTES LUXURY === */
            --gold-gradient: linear-gradient(135deg, #D4AF37 0%, #E8C547 100%);
            --luxury-gradient: linear-gradient(135deg, #F8F5F0 0%, #E8E5E0 50%, #D8D5D0 100%);
            --dark-gradient: linear-gradient(135deg, #1A2035 0%, #2A3552 50%, #1F2B47 100%);
            
            /* === SOMBRAS PREMIUM === */
            --shadow-luxury: 0 12px 40px rgba(26, 32, 53, 0.15), 0 4px 20px rgba(212, 175, 55, 0.1);
            --shadow-glow: 0 0 30px rgba(212, 175, 55, 0.4), 0 0 60px rgba(212, 175, 55, 0.1);
            --shadow-card: 0 8px 32px rgba(26, 32, 53, 0.1), 0 4px 16px rgba(212, 175, 55, 0.05);
            
            /* === TRANSIÇÕES SUAVES === */
            --transition-smooth: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --transition-mind: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            --transition-fast: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--luxury-gradient);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(212,175,55,0.08) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(212,175,55,0.05) 0%, transparent 40%);
            animation: breathingBackground 6s ease-in-out infinite;
        }
        
        @keyframes breathingBackground {
            0%, 100% { 
                background-size: 100% 100%;
                filter: brightness(1);
            }
            50% { 
                background-size: 105% 105%;
                filter: brightness(1.02);
            }
        }
        
        /* === PROGRESS BAR === */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(212, 175, 55, 0.2);
            z-index: 1001;
        }
        
        .progress {
            height: 100%;
            background: var(--gold-gradient);
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
        }
        
        /* === MIND ACTIVITY TRACKER === */
        .mind-tracker {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: rgba(248, 245, 240, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid var(--accent);
            border-radius: 15px;
            padding: 10px 15px;
            font-size: 12px;
            font-weight: 700;
            color: var(--dark);
            z-index: 1000;
            display: none;
            animation: mindPulse 1.2s infinite;
        }
        
        @keyframes mindPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: var(--shadow-card);
            }
            50% { 
                transform: scale(1.02);
                box-shadow: var(--shadow-glow);
            }
        }
        
        .mind-icon {
            color: var(--accent);
            margin-right: 5px;
            animation: mindActivity 1.2s infinite;
        }
        
        @keyframes mindActivity {
            0%, 50%, 100% { transform: scale(1); }
            25%, 75% { transform: scale(1.1); }
        }
        
        /* === TYPING ANALYZER === */
        .typing-analyzer {
            position: fixed;
            top: 80px;
            left: 20px;
            background: rgba(248, 245, 240, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid var(--accent);
            border-radius: 15px;
            padding: 10px 15px;
            font-size: 11px;
            font-weight: 700;
            color: var(--dark);
            z-index: 1000;
            display: none;
            max-width: 200px;
        }
        
        /* === CHAT BUBBLE === */
        .chat {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(248, 245, 240, 0.98);
            backdrop-filter: blur(20px);
            color: var(--text);
            padding: 18px 50px 18px 22px;
            border-radius: 25px;
            max-width: 420px;
            width: calc(100vw - 40px);
            border: 3px solid var(--accent);
            box-shadow: var(--shadow-glow);
            display: none;
            z-index: 1000;
        }
        
        .chat.show {
            display: block;
            animation: chatReveal 0.6s ease-out;
        }
        
        @keyframes chatReveal {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0) scale(1);
            }
        }
        
        .chat-text {
            font-size: 15px;
            font-weight: 700;
            text-align: center;
            margin: 0;
        }
        
        .mic {
            position: absolute;
            top: -10px;
            left: 15px;
            background: var(--accent);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            animation: micPulse 1.2s infinite;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
        }
        
        @keyframes micPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }
        
        /* === CONTAINER PRINCIPAL === */
        .main-container {
            max-width: 420px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        /* === CARD BASE === */
        .card {
            background: rgba(248, 245, 240, 0.98);
            backdrop-filter: blur(30px);
            border-radius: 25px;
            padding: 30px 25px;
            margin: 25px 0;
            border: 2px solid rgba(212, 175, 55, 0.2);
            box-shadow: var(--shadow-card);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gold-gradient);
            box-shadow: 0 2px 15px rgba(212, 175, 55, 0.4);
        }
        
        /* === CARD 1: HERO === */
        .hero-card {
            text-align: center;
            padding: 40px 30px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0;
            backdrop-filter: blur(15px);
            background: rgba(248, 245, 240, 0.02);
            border-radius: 0;
            position: relative;
            overflow: hidden;
        }
        
        .hero-card::before {
            display: none;
        }
        
        .hero-section {
            margin-bottom: 40px;
            opacity: 0;
            animation: heroReveal 1.2s ease-out 0.3s forwards;
            position: relative;
            z-index: 1;
        }
        
        @keyframes heroReveal {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .hero-title {
            font-size: 32px;
            font-weight: 900;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            letter-spacing: -0.5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            animation: titleGlow 4s ease-in-out infinite;
        }
        
        .hero-subtitle {
            font-size: 16px;
            color: var(--text);
            font-weight: 600;
            margin-bottom: 20px;
            font-style: italic;
            opacity: 0.9;
        }
        
        .hero-tagline {
            font-size: 18px;
            color: var(--dark);
            font-weight: 600;
            line-height: 1.5;
            margin-bottom: 20px;
        }
        
        .mind-warning {
            background: rgba(220, 38, 38, 0.1);
            border: 2px solid rgba(220, 38, 38, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            font-size: 14px;
            font-weight: 600;
            color: var(--red);
            animation: warningPulse 3s ease-in-out infinite;
        }
        
        @keyframes warningPulse {
            0%, 100% { 
                box-shadow: 0 0 15px rgba(220, 38, 38, 0.2);
            }
            50% { 
                box-shadow: 0 0 25px rgba(220, 38, 38, 0.4);
            }
        }
        
        /* === AVATAR SECTION === */
        .avatar-section {
            text-align: center;
            margin: 40px 0;
            position: relative;
        }
        
        .avatar-container {
            position: relative;
            display: inline-block;
        }
        
        .avatar {
            width: 400px;
            height: 600px;
            max-width: 90vw;
            object-fit: cover;
            object-position: center;
            border-radius: 20px;
            border: 3px solid rgba(212, 175, 55, 0.4);
            box-shadow: var(--shadow-card);
            transition: var(--transition-smooth);
            display: block;
        }
        
        .avatar:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-glow);
        }
        
        .avatar.speaking {
            animation: speakingGlow 1.8s ease-in-out infinite;
        }
        
        @keyframes speakingGlow {
            0%, 100% { 
                border-color: rgba(212, 175, 55, 0.4);
                box-shadow: var(--shadow-card);
                transform: scale(1);
            }
            50% { 
                border-color: rgba(212, 175, 55, 0.8);
                box-shadow: var(--shadow-glow);
                transform: scale(1.02);
            }
        }
        
        /* === MIND MESSAGE === */
        .mind-message {
            position: absolute;
            top: 29%;
            left: 62%;
            transform: translate(-50%, -50%);
            background: transparent;
            border: none;
            border-radius: 0;
            backdrop-filter: none;
            padding: 8px 12px;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            color: var(--dark);
            text-align: center;
            width: 200px;
            opacity: 0;
            transition: var(--transition-mind);
            z-index: 50;
            pointer-events: none;
            line-height: 1.4;
        }
        
        .mind-message.bubble-mode {
            background: rgba(255, 255, 255, 0.98);
            border: 3px solid var(--accent);
            border-radius: 20px;
            padding: 16px 22px;
            font-family: 'Patrick Hand', cursive;
            font-size: 14px;
            width: 190px;
            box-shadow: var(--shadow-luxury);
            backdrop-filter: blur(10px);
            top: 72%;
            left: 48%;
        }
        
        .mind-message.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
        
        .mind-message.typing {
            animation: typingPulse 0.8s ease-in-out infinite;
        }
        
        @keyframes typingPulse {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1);
                box-shadow: 
                    0 8px 25px rgba(26, 32, 53, 0.15),
                    0 3px 12px rgba(212, 175, 55, 0.2);
            }
            50% { 
                transform: translate(-50%, -50%) scale(1.02);
                box-shadow: 
                    0 12px 35px rgba(26, 32, 53, 0.2),
                    0 4px 16px rgba(212, 175, 55, 0.3);
            }
        }
        
        /* === CORES PREMIUM PARA TEXTO ENHANCED === */
        .mind-text-ola {
            color: #1A2035;
            font-weight: 900;
            font-size: 18px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9), -1px -1px 2px rgba(212,175,55,0.3);
        }
        
        .mind-text-saudacao {
            color: #D4AF37;
            font-weight: 900;
            font-size: 16px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9), -1px -1px 2px rgba(26,32,53,0.2);
        }
        
        .mind-text-tempo {
            color: #006400;
            font-weight: 900;
            font-size: 15px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9), -1px -1px 2px rgba(0,100,0,0.2);
        }
        
        .mind-text-mental {
            color: #8B4513;
            font-weight: 900;
            font-size: 15px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9), -1px -1px 2px rgba(139,69,19,0.2);
        }
        
        .mind-text-telepatia {
            color: #9932CC;
            font-weight: 900;
            font-size: 16px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9), -1px -1px 2px rgba(153,50,204,0.3);
        }
        
        .mind-text-comida {
            color: #FF6347;
            font-weight: 900;
            font-size: 15px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9), -1px -1px 2px rgba(255,99,71,0.2);
        }
        
        .mind-text-regiao {
            color: #2E8B57;
            font-weight: 900;
            font-size: 15px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9), -1px -1px 2px rgba(46,139,87,0.2);
        }
        
        .mind-text-expressao {
            color: #DC143C;
            font-weight: 900;
            font-size: 16px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9), -1px -1px 2px rgba(220,20,60,0.3);
        }
        
        /* === FORMULÁRIO === */
        .form-card {
            width: 100%;
            max-width: 380px;
            margin: 0 auto;
            display: none;
            opacity: 0;
            transform: translateY(50px);
            transition: var(--transition-mind);
        }
        
        .form-card.visible {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        .form-title {
            font-size: 20px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 25px;
            color: var(--text);
            line-height: 1.3;
        }
        
        .name-input {
            width: 100%;
            padding: 18px 22px;
            border: 3px solid var(--accent);
            border-radius: 15px;
            font-size: 17px;
            margin-bottom: 20px;
            font-weight: 600;
            text-align: center;
            background: var(--white);
            color: var(--text);
            transition: var(--transition-fast);
        }
        
        .name-input:focus {
            outline: none;
            border-color: var(--dark);
            background: rgba(248, 245, 240, 0.3);
            box-shadow: 0 0 25px rgba(212, 175, 55, 0.3);
            transform: scale(1.02);
        }
        
        .transform-btn {
            background: var(--dark);
            color: var(--bg);
            border: none;
            padding: 18px 32px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            width: 100%;
            transition: var(--transition-fast);
            letter-spacing: -0.3px;
            box-shadow: var(--shadow-card);
            text-transform: uppercase;
        }
        
        .transform-btn:hover {
            transform: translateY(-2px) scale(1.01);
            box-shadow: var(--shadow-luxury);
            background: linear-gradient(135deg, #2A3552 0%, #1A2035 100%);
        }
        
        .transform-btn:active {
            transform: translateY(0) scale(0.99);
        }
        
        .transform-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        /* === CARDS SEQUENCIAIS === */
        .sequence-container {
            opacity: 0;
            transform: translateY(100px) scale(1.05);
            transition: var(--transition-mind);
            display: none;
        }
        
        .sequence-container.entering {
            opacity: 1;
            transform: translateY(0) scale(1);
            display: block;
        }
        
        .sequence-card {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: var(--transition-smooth);
        }
        
        .sequence-card.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        /* === CARD 2: SISTEMA DE VIRADA APRIMORADO (ORIGINAL) === */
        .page-flip-container {
            perspective: 1200px;
            width: 100%;
            height: 480px;
            margin: 25px 0;
            position: relative;
        }
        
        .page-flip {
            transform-style: preserve-3d;
            transition: transform 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .page-flip.flipped {
            transform: rotateY(-180deg);
        }
        
        .page-front, .page-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 25px;
            padding: 25px;
            box-shadow: var(--shadow-luxury);
            border: 2px solid rgba(212, 175, 55, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        .page-front {
            background: rgba(248, 245, 240, 0.98);
            backdrop-filter: blur(30px);
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .page-front::-webkit-scrollbar {
            width: 8px;
            position: absolute;
            right: 10px;
        }
        
        .page-front::-webkit-scrollbar-track {
            background: rgba(212, 175, 55, 0.1);
            border-radius: 10px;
            margin: 10px 0;
        }
        
        .page-front::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #D4AF37 0%, #B8860B 100%);
            border-radius: 10px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 0 2px 8px rgba(212, 175, 55, 0.4);
        }
        
        .page-front::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #E8C547 0%, #D4AF37 100%);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.6);
        }
        
        .page-front-content {
            min-height: 800px;
            padding-bottom: 50px;
        }
        
        .page-back {
            transform: rotateY(180deg);
            background: var(--dark-gradient);
            color: var(--bg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding: 30px 25px;
        }
        
        /* === MAPA HÍBRIDO 3D/2D INTEGRADO === */
        .hybrid-map-container {
            width: 100%;
            height: 300px;
            margin: 20px 0;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            background: var(--dark-gradient);
        }
        
        /* CANVAS 3D */
        .map-3d-canvas {
            width: 100%;
            height: 100%;
            display: block;
            border-radius: 20px;
        }
        
        /* MAPA 2D */
        .map-2d-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 30px 20px;
        }
        
        .energy-route-2d {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            max-width: 280px;
        }
        
        .map-point-2d {
            background: rgba(248, 245, 240, 0.95);
            color: var(--dark);
            padding: 12px 16px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 800;
            text-align: center;
            min-width: 70px;
            box-shadow: var(--shadow-card);
            border: 2px solid var(--accent);
        }
        
        .energy-beam-2d {
            flex: 1;
            text-align: center;
            font-size: 18px;
            margin: 0 15px;
            animation: beam2DPulse 1.5s infinite;
            color: var(--accent);
        }
        
        @keyframes beam2DPulse {
            0%, 100% { 
                opacity: 0.6; 
                transform: scale(1);
                text-shadow: 0 0 10px var(--accent);
            }
            50% { 
                opacity: 1; 
                transform: scale(1.1);
                text-shadow: 0 0 20px var(--accent);
            }
        }
        
        .distance-2d {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--accent);
            font-size: 12px;
            font-weight: 800;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.6);
        }
        
        /* FALLBACK SIMPLES */
        .map-fallback {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 20px;
        }
        
        .fallback-content {
            text-align: center;
            color: var(--bg);
        }
        
        .fallback-title {
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 15px;
            color: var(--accent);
        }
        
        .fallback-route {
            font-size: 14px;
            font-weight: 600;
            line-height: 1.6;
        }
        
        /* === DADOS REGIONAIS OTIMIZADOS (ORIGINAL) === */
        .complete-reveal {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .personal-temporal {
            background: linear-gradient(135deg, #D4AF37 0%, #E8C547 30%, #FFD700 70%, #B8860B 100%);
            color: var(--dark);
            padding: 25px 20px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 
                0 15px 45px rgba(212, 175, 55, 0.4),
                0 5px 25px rgba(212, 175, 55, 0.2);
            font-size: 16px;
            font-weight: 800;
            line-height: 1.4;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .cultural-connect {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 245, 240, 0.9) 100%);
            backdrop-filter: blur(20px);
            padding: 20px;
            border-radius: 18px;
            text-align: center;
            font-weight: 800;
            font-size: 16px;
            color: var(--dark);
            box-shadow: 
                0 8px 25px rgba(26, 32, 53, 0.1),
                0 3px 12px rgba(212, 175, 55, 0.15);
            border: 2px solid rgba(212, 175, 55, 0.3);
        }
        
        .scientific-precision {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.08) 100%);
            backdrop-filter: blur(20px);
            padding: 20px;
            border-radius: 18px;
            text-align: center;
            font-weight: 800;
            font-size: 16px;
            color: var(--dark);
            box-shadow: 
                0 8px 25px rgba(212, 175, 55, 0.2),
                0 3px 12px rgba(212, 175, 55, 0.1);
            border: 2px solid rgba(212, 175, 55, 0.4);
        }
        
        .mind-revelation-final {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.15) 0%, rgba(220, 38, 38, 0.08) 100%);
            backdrop-filter: blur(20px);
            padding: 25px 20px;
            border-radius: 18px;
            text-align: center;
            font-weight: 900;
            font-size: 18px;
            color: var(--red);
            box-shadow: 
                0 8px 25px rgba(220, 38, 38, 0.2),
                0 3px 12px rgba(220, 38, 38, 0.1);
            border: 2px solid rgba(220, 38, 38, 0.3);
            animation: revelationPulse 2s ease-in-out infinite;
        }
        
        @keyframes revelationPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 
                    0 8px 25px rgba(220, 38, 38, 0.2),
                    0 3px 12px rgba(220, 38, 38, 0.1);
            }
            50% { 
                transform: scale(1.02);
                box-shadow: 
                    0 12px 35px rgba(220, 38, 38, 0.3),
                    0 4px 16px rgba(220, 38, 38, 0.2);
            }
        }
        
        /* === PÁGINA TRASEIRA - MAPA ENERGÉTICO (ORIGINAL) === */
        .energy-map {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding: 40px 20px;
        }
        
        .map-title {
            color: var(--accent);
            font-size: 16px;
            font-weight: 800;
            text-shadow: 0 0 25px rgba(212, 175, 55, 0.8);
            margin-bottom: 30px;
            text-align: center;
            letter-spacing: 0.5px;
        }
        
        /* === ENERGY ROUTE HÍBRIDA === */
        .energy-route {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 300px;
            margin: 0 auto 30px auto;
            position: relative;
        }
        
        .route-point {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--bg);
            font-weight: 800;
            font-size: 11px;
            line-height: 1.2;
            white-space: nowrap;
        }
        
        .energy-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-bottom: 8px;
            animation: energyPulse 2.5s infinite;
            box-shadow: 0 0 20px currentColor;
        }
        
        .energy-dot.origin {
            background: var(--accent);
            color: var(--accent);
        }
        
        .energy-dot.destination {
            background: var(--bg);
            color: var(--bg);
            animation-delay: 0.7s;
        }
        
        @keyframes energyPulse {
            0%, 100% { 
                transform: scale(1); 
                opacity: 1;
                box-shadow: 0 0 20px currentColor;
            }
            50% { 
                transform: scale(1.3); 
                opacity: 0.9;
                box-shadow: 0 0 30px currentColor;
            }
        }
        
        .energy-line {
            flex: 1;
            height: 4px;
            background: linear-gradient(90deg, var(--accent) 0%, var(--bg) 100%);
            margin: 0 20px;
            border-radius: 2px;
            position: relative;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
            animation: energyFlow 3s ease-in-out infinite;
        }
        
        @keyframes energyFlow {
            0% { 
                background: linear-gradient(90deg, var(--accent) 100%, var(--bg) 0%);
                box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
            }
            50% { 
                background: linear-gradient(90deg, var(--accent) 50%, var(--bg) 50%);
                box-shadow: 0 0 25px rgba(212, 175, 55, 0.8);
            }
            100% { 
                background: linear-gradient(90deg, var(--accent) 0%, var(--bg) 100%);
                box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
            }
        }
        
        .traveling-pulse {
            position: absolute;
            top: 50%;
            left: 0;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(212,175,55,0.9) 100%);
            border-radius: 50%;
            transform: translateY(-50%);
            animation: travelPulse 3s ease-in-out infinite;
            box-shadow: 0 0 15px rgba(255,255,255,0.9);
        }
        
        @keyframes travelPulse {
            0% {
                left: 0;
                opacity: 1;
                transform: translateY(-50%) scale(1);
            }
            50% {
                left: 50%;
                opacity: 0.8;
                transform: translateY(-50%) scale(1.5);
            }
            100% {
                left: 100%;
                opacity: 1;
                transform: translateY(-50%) scale(1);
            }
        }
        
        .distance-info {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--accent);
            font-size: 10px;
            font-weight: 800;
            white-space: nowrap;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.8);
        }
        
        /* === QUIZ MENTALIDADE (ORIGINAL) === */
        .mentality-card {
            background: rgba(248, 245, 240, 0.98);
            backdrop-filter: blur(30px);
            border: 3px solid #D4AF37;
            border-radius: 25px;
            padding: 30px 25px;
            margin: 25px 0;
            text-align: center;
            box-shadow: var(--shadow-luxury);
            position: relative;
            overflow: hidden;
        }
        
        .mentality-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gold-gradient);
            box-shadow: 0 2px 15px rgba(212, 175, 55, 0.4);
        }
        
        .mentality-title {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 25px;
            color: var(--dark);
            line-height: 1.3;
        }
        
        .test-items-three {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px;
            margin: 25px 0;
        }
        
        .test-items-three .test-item:last-child {
            grid-column: 1/-1;
            max-width: 280px;
            margin: 0 auto;
        }
        
        .test-item {
            background: white;
            border: 3px solid rgba(212, 175, 55, 0.3);
            border-radius: 18px;
            padding: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .test-item.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .test-item.forbidden {
            background: rgba(255, 71, 87, 0.15);
            border-color: #ef4444;
            animation: forbiddenPulse 1.5s infinite;
        }
        
        @keyframes forbiddenPulse {
            0%, 100% { box-shadow: 0 0 15px rgba(255, 71, 87, 0.3); }
            50% { box-shadow: 0 0 25px rgba(255, 71, 87, 0.6); }
        }
        
        .test-item:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-glow);
        }
        
        .test-icon {
            font-size: 40px;
            display: block;
            margin-bottom: 10px;
        }
        
        .test-label {
            font-size: 14px;
            font-weight: 800;
            color: var(--dark);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            line-height: 1.1;
            text-align: center;
        }
        
        .revelation {
            background: rgba(255, 71, 87, 0.15);
            border: 3px solid #ef4444;
            border-radius: 18px;
            padding: 25px;
            margin: 25px 0;
            display: none;
            animation: revelationGlow 2s infinite;
        }
        
        @keyframes revelationGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 71, 87, 0.4); }
            50% { box-shadow: 0 0 30px rgba(255, 71, 87, 0.7); }
        }
        
        .revelation-title {
            color: var(--red);
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 900;
            line-height: 1.3;
        }
        
        .revelation-description {
            font-weight: 600;
            line-height: 1.5;
            font-size: 15px;
            color: var(--dark);
        }
        
        /* === DIAGNÓSTICO (ORIGINAL) === */
        .diagnosis-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .diagnosis-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 15px;
            line-height: 1.3;
        }
        
        .user-highlight {
            color: var(--accent);
            font-weight: 900;
        }
        
        .problems-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 30px;
            position: relative;
            opacity: 0;
            transform: translateY(20px);
            transition: var(--transition-smooth);
        }
        
        .problems-grid.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .problem-card {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(212, 175, 55, 0.2);
            border-radius: 15px;
            padding: 18px 12px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition-mind);
            position: relative;
            overflow: hidden;
            opacity: 0;
            transform: translateY(30px) scale(0.9);
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .problem-card.visible {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        
        .problem-card:hover {
            transform: translateY(-3px) scale(1.02);
            border-color: var(--accent);
            box-shadow: var(--shadow-glow);
        }
        
        .problem-icon {
            font-size: 28px;
            margin-bottom: 8px;
            display: block;
        }
        
        .problem-name {
            font-size: 13px;
            font-weight: 800;
            color: var(--dark);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            line-height: 1.1;
            text-align: center;
        }
        
        .problem-name small {
            font-size: 10px;
            display: block;
            margin-top: 4px;
            font-weight: 600;
            color: var(--accent);
            text-transform: none;
            letter-spacing: 0;
        }
        
        /* === TIMER DE ESCOLHA === */
        .choice-timer {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 16px;
            box-shadow: var(--shadow-card);
            animation: timerPulse 1s infinite;
            border: 2px solid rgba(255, 0, 0, 0.3);
        }
        
        @keyframes timerPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: var(--shadow-card);
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 0 0 20px 5px rgba(255, 0, 0, 0.6);
            }
        }
        
        /* === SISTEMA DE FALSA TRAVA === */
        .lock-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 32, 53, 0.95);
            backdrop-filter: blur(20px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: lockFadeIn 0.8s ease-out;
        }
        
        .lock-content {
            background: rgba(248, 245, 240, 0.98);
            backdrop-filter: blur(30px);
            border-radius: 25px;
            padding: 40px 30px;
            text-align: center;
            max-width: 400px;
            margin: 0 20px;
            box-shadow: var(--shadow-luxury);
            border: 3px solid var(--accent);
            position: relative;
            overflow: hidden;
        }
        
        .lock-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gold-gradient);
            animation: lockPulse 2s ease-in-out infinite;
        }
        
        @keyframes lockPulse {
            0%, 100% { 
                opacity: 1;
                transform: scaleX(1);
            }
            50% { 
                opacity: 0.7;
                transform: scaleX(1.05);
            }
        }
        
        .lock-phase {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease-out;
        }
        
        .lock-phase.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        /* FASE 1: ANÁLISE FAKE */
        .analysis-phase {
            color: var(--dark);
        }
        
        .analysis-title {
            font-size: 24px;
            font-weight: 900;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }
        
        .analysis-text {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 25px;
            line-height: 1.4;
        }
        
        .analysis-progress {
            width: 100%;
            height: 6px;
            background: rgba(212, 175, 55, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .analysis-bar {
            height: 100%;
            background: var(--gold-gradient);
            width: 0%;
            border-radius: 3px;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.6);
        }
        
        .analysis-status {
            font-size: 14px;
            color: var(--accent);
            font-weight: 700;
            animation: statusBlink 1s infinite;
        }
        
        @keyframes statusBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        /* FASE 2: CONVERSÃO FINAL */
        .conversion-phase {
            color: var(--dark);
        }
        
        .conversion-cta {
            background: var(--gold-gradient);
            color: var(--dark);
            border: none;
            padding: 18px 35px;
            border-radius: 15px;
            font-size: 17px;
            font-weight: 900;
            cursor: pointer;
            width: 100%;
            transition: var(--transition-fast);
            box-shadow: var(--shadow-luxury);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 20px;
            animation: ctaPulseStrong 2s infinite;
        }
        
        @keyframes ctaPulseStrong {
            0%, 100% { 
                transform: scale(1);
                box-shadow: var(--shadow-luxury);
            }
            50% { 
                transform: scale(1.02);
                box-shadow: var(--shadow-glow);
            }
        }
        
        .conversion-cta:hover {
            transform: translateY(-2px) scale(1.01);
            box-shadow: var(--shadow-glow);
        }
        
        .price-info {
            font-size: 14px;
            color: var(--dark);
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .urgency-text {
            font-size: 12px;
            color: var(--red);
            font-weight: 800;
            text-transform: uppercase;
            animation: urgencyBlink 1.5s infinite;
        }
        
        @keyframes urgencyBlink {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }
        
        /* ESCAPE HATCH */
        .escape-option {
            margin-top: 20px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.8s ease-out;
        }
        
        .escape-option.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .escape-link {
            font-size: 11px;
            color: rgba(26, 32, 53, 0.6);
            text-decoration: underline;
            cursor: pointer;
            transition: var(--transition-fast);
        }
        
        .escape-link:hover {
            color: rgba(26, 32, 53, 0.8);
        }
        
        @keyframes lockFadeIn {
            from {
                opacity: 0;
                backdrop-filter: blur(0px);
            }
            to {
                opacity: 1;
                backdrop-filter: blur(20px);
            }
        }
        
        /* === SISTEMA DE BUBBLES SEQUENCIAIS TTS === */
        .tts-bubble {
            position: fixed;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(25px);
            border: 2px solid rgba(212, 175, 55, 0.5);
            border-radius: 12px;
            padding: 8px 12px;
            font-family: 'Inter', sans-serif;
            font-size: 11px;
            font-weight: 700;
            color: var(--dark);
            text-align: center;
            max-width: 180px;
            min-width: 120px;
            line-height: 1.2;
            opacity: 0;
            transform: translateX(-50%) translateY(15px) scale(0.9);
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1050;
            box-shadow: 
                0 6px 20px rgba(212, 175, 55, 0.2),
                0 3px 10px rgba(26, 32, 53, 0.15);
            pointer-events: none;
        }
        
        .tts-bubble.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0) scale(1);
        }
        
        .tts-bubble.speaking {
            animation: bubblePulse 1.5s ease-in-out infinite;
        }
        
        @keyframes bubblePulse {
            0%, 100% { 
                transform: translateX(-50%) translateY(0) scale(1);
                border-color: rgba(212, 175, 55, 0.5);
                background: rgba(255, 255, 255, 0.95);
                box-shadow: 
                    0 6px 20px rgba(212, 175, 55, 0.2),
                    0 3px 10px rgba(26, 32, 53, 0.15);
            }
            50% { 
                transform: translateX(-50%) translateY(0) scale(1.02);
                border-color: rgba(212, 175, 55, 0.7);
                background: rgba(255, 255, 255, 0.98);
                box-shadow: 
                    0 8px 25px rgba(212, 175, 55, 0.3),
                    0 4px 15px rgba(26, 32, 53, 0.2);
            }
        }
        
        .tts-bubble.fade-out {
            opacity: 0;
            transform: translateX(-50%) translateY(10px) scale(0.95);
            transition: all 0.3s ease-in-out;
        }
        
        .bubble-icon {
            display: inline-block;
            margin-right: 4px;
            font-size: 10px;
            animation: iconFloat 2s ease-in-out infinite;
        }
        
        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-1px); }
        }
        
        /* === RESPONSIVE === */
        @media (max-width: 480px) {
            .main-container {
                padding: 15px;
            }
            
            .hero-title {
                font-size: 28px;
            }
            
            .avatar {
                width: 320px;
                height: 480px;
                max-width: 85vw;
            }
            
            .mind-message {
                font-size: 14px;
                width: 160px;
                padding: 6px 10px;
                top: 29%;
                left: 62%;
            }
            
            .mind-message.bubble-mode {
                font-size: 12px;
                width: 140px;
                padding: 14px 18px;
                top: 72%;
                left: 48%;
            }
            
            .page-flip-container {
                height: 400px;
            }
            
            .page-front, .page-back {
                padding: 20px 18px;
            }
            
            .hybrid-map-container {
                height: 250px;
            }
            
            .tts-bubble {
                max-width: 160px;
                min-width: 100px;
                padding: 6px 10px;
                font-size: 10px;
                border-radius: 10px;
                bottom: 20px;
            }
            
            .test-items-three {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .test-items-three .test-item:last-child {
                grid-column: 1;
                max-width: 100%;
            }
            
            .test-item {
                padding: 15px;
                min-height: 90px;
            }
            
            .test-icon {
                font-size: 35px;
            }
            
            .problems-grid {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
            
            .problem-card {
                padding: 15px 8px;
                min-height: 90px;
            }
            
            .problem-icon {
                font-size: 24px;
                margin-bottom: 6px;
            }
            
            .problem-name {
                font-size: 11px;
            }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* === UTILITY CLASSES === */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
    </style>
</head>
<body>
    <!-- === PROGRESS BAR === -->
    <div class="loader">
        <div class="progress" id="progress"></div>
    </div>

    <!-- === MIND ACTIVITY TRACKER === -->
    <div class="mind-tracker" id="mindTracker">
        <span class="mind-icon">🧠</span>
        <span id="mindText">Neurônios: 847</span>
    </div>

    <!-- === TYPING ANALYZER === -->
    <div class="typing-analyzer" id="typingAnalyzer">
        <div>⌨️ Velocidade: <span id="typingSpeed">0</span> CPM</div>
        <div>🧠 Hesitação: <span id="hesitation">Normal</span></div>
    </div>

    <!-- === CHAT BUBBLE === -->
    <div id="chat" class="chat">
        <div class="mic">🎤</div>
        <div class="chat-text" id="chatText"></div>
    </div>

    <!-- === SISTEMA DE BUBBLES SEQUENCIAIS TTS === -->
    <div class="tts-bubble" id="ttsBubble">
        <span class="bubble-icon">💭</span>
        <span id="bubbleText">Mensagem mental...</span>
    </div>

    <!-- === CARD 1: HERO + FORMULÁRIO === -->
    <div class="main-container">
        <div class="card hero-card">
            <!-- Hero Section -->
            <div class="hero-section">
                <h1 class="hero-title">ADRIANA SOUSA</h1>
                <p class="hero-subtitle"><em>Conhecer a ti mesmo</em></p>
                <p class="hero-tagline">
                    Transforme confusão em clareza. Medo em ação. E dúvida em decisão.
                </p>
                <div class="mind-warning">
                    ⚠️ <strong>Aviso:</strong> Esta experiência pode revelar verdades sobre sua mente que você ainda não estava pronto para ver.
                </div>
            </div>
            
            <!-- Avatar Section -->
            <div class="avatar-section">
                <div class="avatar-container">
                    <img src="https://github.com/marcelo-davila-setup/dris/raw/main/Design%20sem%20nome.png" 
                         alt="Adriana Sousa - Transformação Mental" 
                         class="avatar" 
                         id="mainAvatar"
                         loading="eager"
                         onerror="this.src='https://via.placeholder.com/400x600/F8F5F0/1A2035?text=ADRIANA+SOUSA'"
                         width="400"
                         height="600">
                    
                    <div class="mind-message" id="mindMessage">
                        <!-- Mensagem será preenchida dinamicamente -->
                    </div>
                </div>
            </div>
            
            <!-- Formulário -->
            <div class="card form-card" id="formCard">
                <h2 class="form-title">Qual seu nome para revelarmos juntos o que sua mente esconde de você?</h2>
                <input 
                    type="text" 
                    class="name-input" 
                    id="nameInput" 
                    placeholder="Digite seu primeiro nome" 
                    maxlength="25"
                    autocomplete="given-name"
                >
                <button class="transform-btn" id="transformBtn" type="button">
                    🚀 Começar Transformação Mental
                </button>
            </div>
        </div>
    </div>

    <!-- === SEQUÊNCIA DE CARDS (ORIGINAL COM MAPAS HÍBRIDOS) === -->
    <div class="main-container sequence-container" id="sequenceContainer">
        
        <!-- === CARD 2: SISTEMA DE VIRADA REGIONAL COM MAPA HÍBRIDO === -->
        <div class="card sequence-card" id="regionalCard">
            <div class="page-flip-container">
                <div class="page-flip" id="pageFlip">
                    
                    <!-- PÁGINA FRONTAL: DADOS REGIONAIS OTIMIZADOS -->
                    <div class="page-front">
                        <div class="page-front-content">
                            <div class="complete-reveal">
                                <!-- Bloco 1: Dados pessoais + temporais -->
                                <div class="personal-temporal" data-scroll-target="personal">
                                    🧠 <span id="dayGreeting">E aí</span>, <span id="userName1">Nome</span>!<br>
                                    📅 <span id="currentDate">3 de agosto</span>, <span id="currentTime">16:42</span><br>
                                    📍 <span id="cityName">São Paulo</span>
                                </div>
                                
                                <!-- Bloco 2: Conexão cultural -->  
                                <div class="cultural-connect" data-scroll-target="cultural">
                                    🍕 Tem <span id="food1">coxinha</span> e <span id="food2">pastel</span> aí
                                </div>
                                
                                <!-- Bloco 3: Precisão científica -->
                                <div class="scientific-precision" data-scroll-target="scientific">
                                    🗺️ <span id="distance">494</span> quilômetros de Timóteo até você
                                </div>
                                
                                <!-- Bloco 4: Revelação -->
                                <div class="mind-revelation-final" data-scroll-target="revelation">  
                                    ⚡ <strong>Nada é por acaso!</strong>
                                </div>
                            </div>
                            
                            <!-- CONTEÚDO ADICIONAL PARA SCROLL -->
                            <div class="extra-content" data-scroll-target="extra">
                                <div class="mind-revelation" style="margin-top: 40px; background: rgba(212, 175, 55, 0.1);">
                                    <div class="mind-icon">🎯</div>
                                    <div class="revelation-text">
                                        <strong>Sua mente já tinha decidido.</strong><br>
                                        A prova?<br>
                                        Você está aqui.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PÁGINA TRASEIRA: MAPA ENERGÉTICO HÍBRIDO -->
                    <div class="page-back">
                        <div class="energy-map">
                            <div class="map-title">🗺️ ROTA DA TRANSFORMAÇÃO MENTAL</div>
                            
                            <!-- MAPA HÍBRIDO 3D/2D/FALLBACK -->
                            <div class="hybrid-map-container" id="hybridMapContainer">
                                <!-- CANVAS 3D -->
                                <canvas class="map-3d-canvas" id="map3DCanvas"></canvas>
                                
                                <!-- MAPA 2D -->
                                <div class="map-2d-container" id="map2DContainer">
                                    <div class="energy-route-2d">
                                        <div class="map-point-2d">
                                            📍 Timóteo-MG<br>
                                            <small>Origem</small>
                                        </div>
                                        <div class="energy-beam-2d" id="energyBeam2D">⚡⚡⚡</div>
                                        <div class="map-point-2d">
                                            📍 <span id="userCity2D">Sua Cidade</span><br>
                                            <small>Destino</small>
                                        </div>
                                    </div>
                                    <div class="distance-2d" id="distance2D">494 km</div>
                                </div>
                                
                                <!-- FALLBACK SIMPLES -->
                                <div class="map-fallback" id="mapFallback">
                                    <div class="fallback-content">
                                        <div class="fallback-title">🧠 CONEXÃO MENTAL ATIVA</div>
                                        <div class="fallback-route">
                                            📍 Timóteo-MG ⚡⚡⚡ <span id="userCityFallback">Sua Cidade</span><br>
                                            <strong><span id="distanceFallback">494</span> km de energia mental</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ROTA ORIGINAL (se mapa híbrido falhar) -->
                            <div class="energy-route" id="originalEnergyRoute">
                                <div class="route-point">
                                    <div class="energy-dot origin"></div>
                                    <span id="originName">Timóteo-MG<br><small>Origem</small></span>
                                </div>
                                
                                <div class="energy-line">
                                    <div class="traveling-pulse"></div>
                                    <div class="distance-info" id="distanceInfo">186km • 0,003s</div>
                                </div>
                                
                                <div class="route-point">
                                    <div class="energy-dot destination"></div>
                                    <span id="destinationName">Sua Cidade<br><small>Destino</small></span>
                                </div>
                            </div>
                            
                            <div class="energy-quote" id="energyQuote">
                                "A dor que você não olha<br>te dirige em silêncio"
                            </div>
                            
                            <div class="connection-status">
                                ✨ Energia mental transmitida via frequência ancestral
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- === CARD 2.5: QUIZ MENTALIDADE === -->
        <div class="card sequence-card mentality-card" id="mentalityCard">
            <h2 class="mentality-title">
                🧠 <span id="userName5">Nome</span>, vou provar que sua mente te sabota...
            </h2>
            
            <div class="test-items-three" id="testItems">
                <div class="test-item" id="testPlane">
                    <span class="test-icon">✈️</span>
                    <span class="test-label">Pense num AVIÃO</span>
                </div>
                
                <div class="test-item" id="testCar">
                    <span class="test-icon">🚗</span>
                    <span class="test-label">Pense num CARRO</span>
                </div>
                
                <div class="test-item" id="testBike">
                    <span class="test-icon">🏍️</span>
                    <span class="test-label">NÃO pense numa MOTO</span>
                </div>
            </div>
            
            <div class="revelation" id="mentalityRevelation">
                <h3 class="revelation-title">
                    🤯 <span id="userName6">Nome</span>, pensou na moto mesmo eu pedindo para NÃO pensar?
                </h3>
                <p class="revelation-description">
                    <strong>Sua mente não lê a palavra NÃO, o NÃO é uma afirmação</strong><br><br>
                    Entre o impulso e a ação, existe um abismo que você nunca viu. 
                    Sua mente já decidiu tudo... incluindo vir até aqui.
                </p>
            </div>
        </div>

        <!-- === CARD 3: DIAGNÓSTICO === -->
        <div class="card sequence-card" id="diagnosisCard">
            <div class="choice-timer" id="choiceTimer">15</div>
            
            <div class="diagnosis-header">
                <h2 class="diagnosis-title">
                    <span class="user-highlight" id="userName2">Nome</span>, agora que provei que sua mente te controla...<br>
                    Qual dessas dores ela mais usa para te <strong>paralizar</strong>?
                </h2>
            </div>
            
            <div class="problems-grid">
                <div class="problem-card" data-problema="ansiedade" onclick="selectProblem('ansiedade')">
                    <div class="problem-icon">😰</div>
                    <div class="problem-name">Ansiedade<br><small>Mais comum - 76%</small></div>
                </div>
                
                <div class="problem-card" data-problema="procrastinacao" onclick="selectProblem('procrastinacao')">
                    <div class="problem-icon">⏰</div>
                    <div class="problem-name">Procrastinação<br><small>2º lugar - 68%</small></div>
                </div>
                
                <div class="problem-card" data-problema="impostor" onclick="selectProblem('impostor')">
                    <div class="problem-icon">🎭</div>
                    <div class="problem-name">Síndrome do Impostor<br><small>3º lugar</small></div>
                </div>
                
                <div class="problem-card" data-problema="burnout" onclick="selectProblem('burnout')">
                    <div class="problem-icon">🔥</div>
                    <div class="problem-name">Burnout<br><small>Esgotamento</small></div>
                </div>
                
                <div class="problem-card" data-problema="relacionamentos" onclick="selectProblem('relacionamentos')">
                    <div class="problem-icon">💔</div>
                    <div class="problem-name">Relacionamentos<br><small>Tóxicos</small></div>
                </div>
                
                <div class="problem-card" data-problema="autoestima" onclick="selectProblem('autoestima')">
                    <div class="problem-icon">🪞</div>
                    <div class="problem-name">Baixa Autoestima<br><small>Autoimagem</small></div>
                </div>
                
                <div class="problem-card" data-problema="financeiros" onclick="selectProblem('financeiros')">
                    <div class="problem-icon">💰</div>
                    <div class="problem-name">Bloqueios Financeiros<br><small>Dinheiro</small></div>
                </div>
                
                <div class="problem-card" data-problema="profissionais" onclick="selectProblem('profissionais')">
                    <div class="problem-icon">📈</div>
                    <div class="problem-name">Bloqueios Profissionais<br><small>Carreira</small></div>
                </div>
                
                <div class="problem-card" data-problema="todos" onclick="selectProblem('todos')">
                    <div class="problem-icon">🧠</div>
                    <div class="problem-name">Todos Acima<br><small>Mais revelador</small></div>
                </div>
                
                <div class="problem-card" data-problema="naosei" onclick="selectProblem('naosei')">
                    <div class="problem-icon">🤔</div>
                    <div class="problem-name">Não Sei Identificar</div>
                </div>
            </div>
        </div>
        
        <!-- === SISTEMA DE CONVERSÃO FINAL === -->
        <div class="lock-overlay" id="lockOverlay">
            <div class="lock-content">
                
                <!-- FASE 1: ANÁLISE FAKE -->
                <div class="lock-phase analysis-phase" id="analysisPhase">
                    <h2 class="analysis-title">🔍 ANALISANDO</h2>
                    <p class="analysis-text">
                        Escaneando padrões neurais de <span id="selectedProblemText">ansiedade</span>...
                    </p>
                    <div class="analysis-progress">
                        <div class="analysis-bar" id="analysisBar"></div>
                    </div>
                    <p class="analysis-status" id="analysisStatus">Identificando bloqueios...</p>
                </div>
                
                <!-- FASE 2: CONVERSÃO FINAL -->
                <div class="lock-phase conversion-phase" id="conversionPhase">
                    <h2 class="analysis-title" id="conversionTitle">
                        🤯 O SILÊNCIO REVELOU TUDO
                    </h2>
                    <p class="analysis-text" id="conversionDesc">
                        <span id="userName7">Nome</span>, o vazio que você sentiu é o mesmo vazio que sua <span id="problemType">ansiedade</span> deixa na sua vida. 
                        Posso preencher esse vazio em 47 dias.
                    </p>
                    
                    <div class="price-info">
                        <strong>Terapeutas cobram R$ 200/sessão (mín. 10 = R$ 2.000)</strong><br>
                        Minha solução completa:
                    </div>
                    
                    <button class="conversion-cta" id="conversionCTA" onclick="redirectToTransformation()">
                        💙 Preencher o Vazio - R$ 47,00
                    </button>
                    
                    <div class="price-info">
                        <small>Ou 3x de R$ 19,90 (menos que 1 café por dia)</small><br>
                        <strong>⚡ Oferta válida apenas nesta página</strong>
                    </div>
                    
                    <p class="urgency-text">⚡ Sua mente está pronta AGORA ou nunca ⚡</p>
                    
                    <!-- ESCAPE HATCH (aparece depois) -->
                    <div class="escape-option" id="escapeOption">
                        <span class="escape-link" onclick="continueWithoutSolution()">
                            ou continuar convivendo com o vazio
                        </span>
                    </div>
                </div>
                
            </div>
        </div>

    </div>

    <script>
        // === SISTEMA DE VIBRAÇÃO REVERSA ESTRATÉGICA ===
        class MindVibration {
            constructor() {
                this.isSupported = 'vibrate' in navigator;
                this.userConsent = false;
                this.silentMode = false;
                this.conditioningLevel = 0;
                console.log('📳 Sistema de vibração REVERSA inicializado:', this.isSupported);
            }
            
            // Padrões de vibração REVERSA
            patterns = {
                // CONDICIONAMENTO (vibra ANTES)
                anticipate: [100, 50, 150, 50, 200], // Crescente antes
                buildUp: [50, 100, 50, 200, 50, 300], // Build up progressivo
                thinking: [80, 40, 80, 40], // Durante pausas
                
                // SILENCE SHOCK (NÃO vibra quando esperado)
                silence: [], // Vazio devastador
                void: [], // Ausência total
                
                // FRUSTRAÇÃO (vibra quando erra)
                wrong: [200, 200, 200], // Tripla no erro
                mistake: [150, 150], // Dupla no engano
                
                // MOMENTOS ESPECÍFICOS
                revelation: [50, 100, 50, 100, 50], // Antes da revelação
                connection: [100, 50, 100], // Antes da conexão
                choice: [300, 100], // Durante escolhas
                urgency: [400, 200, 400] // Pressão final
            };
            
            async checkSilentMode() {
                try {
                    const audio = new Audio();
                    audio.volume = 0.01;
                    audio.muted = true;
                    
                    const testSound = 'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvGYdBSuF1fDBfigGKIPK79iIOwchc8r0zn0vBSZ8+';
                    
                    audio.src = testSound;
                    await audio.play();
                    this.silentMode = false;
                } catch (error) {
                    this.silentMode = true;
                }
                
                console.log('🔇 Modo silencioso:', this.silentMode);
                return this.silentMode;
            }
            
            // VIBRAÇÃO REVERSA ESTRATÉGICA
            async strategicVibrate(context, force = false) {
                if (!this.isSupported) return false;
                
                await this.checkSilentMode();
                
                const pattern = this.patterns[context] || [];
                
                // SILENCE SHOCK - NÃO vibra quando mais esperado
                if (context === 'silence' || context === 'void') {
                    console.log(`🔕 SILENCE SHOCK: ${context} - NÃO VIBRANDO`);
                    return true; // "Sucesso" em não vibrar
                }
                
                try {
                    if (pattern.length > 0) {
                        navigator.vibrate(pattern);
                        console.log(`📳 Vibração REVERSA ${context}:`, pattern);
                        
                        // Incrementar condicionamento
                        this.conditioningLevel++;
                    }
                    return true;
                } catch (error) {
                    console.warn('📳 Vibração falhou:', error);
                    return false;
                }
            }
            
            // MOMENTOS REVERSOS ESPECÍFICOS
            onReverseMoment(moment) {
                switch(moment) {
                    case 'before_name_reveal':
                        // Vibra 2s ANTES de revelar dados
                        this.strategicVibrate('anticipate');
                        break;
                        
                    case 'wrong_guess':
                        // Vibra quando "erra" de propósito
                        this.strategicVibrate('wrong');
                        break;
                        
                    case 'thinking_pause':
                        // Vibra durante pausas do discurso
                        this.strategicVibrate('thinking');
                        break;
                        
                    case 'choice_hover_wrong':
                        // Vibra quando hover no errado
                        this.strategicVibrate('mistake');
                        break;
                        
                    case 'choice_hover_right':
                        // NÃO vibra quando hover no certo
                        this.strategicVibrate('silence');
                        break;
                        
                    case 'revelation_buildup':
                        // Vibra ANTES da grande revelação
                        this.strategicVibrate('buildUp');
                        break;
                        
                    case 'silence_shock':
                        // O momento mais poderoso - SILÊNCIO TOTAL
                        this.strategicVibrate('void');
                        break;
                        
                    case 'final_urgency':
                        // Vibração de urgência final
                        this.strategicVibrate('urgency');
                        break;
                }
            }
            
            // CONDICIONAMENTO PROGRESSIVO
            startConditioning() {
                console.log('🧠 Iniciando condicionamento vibratório...');
                
                // Padrão consistente no início
                const conditioningPattern = () => {
                    this.strategicVibrate('connection');
                    
                    setTimeout(() => {
                        // Depois de condicionar, quebrar o padrão
                        if (this.conditioningLevel >= 3) {
                            console.log('💥 Condicionamento estabelecido - pronto para SILENCE SHOCK');
                        }
                    }, 2000);
                };
                
                return conditioningPattern;
            }
        }

        // === SISTEMA DE DETECÇÃO DE DEVICE INTELIGENTE ===
        class DeviceCapability {
            constructor() {
                this.canvas = document.createElement('canvas');
                this.gl = this.canvas.getContext('webgl') || this.canvas.getContext('experimental-webgl');
                this.ram = navigator.deviceMemory || 2;
                this.cores = navigator.hardwareConcurrency || 2;
                this.connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
                
                this.canUse3D = this.ram >= 4 && this.cores >= 4 && !!this.gl;
                this.canUse2D = this.ram >= 2 && this.cores >= 2;
                this.needsFallback = !this.canUse2D;
                
                console.log('💻 Device Capability:', {
                    ram: this.ram + 'GB',
                    cores: this.cores,
                    webGL: !!this.gl,
                    canUse3D: this.canUse3D,
                    canUse2D: this.canUse2D,
                    needsFallback: this.needsFallback,
                    connection: this.connection?.effectiveType || 'unknown'
                });
            }
        }

        // === MAPA HÍBRIDO COMPLETO (3D → 2D → FALLBACK) ===
        class HybridMap {
            constructor(container) {
                this.container = container;
                this.device = new DeviceCapability();
                this.scene = null;
                this.camera = null;
                this.renderer = null;
                this.animationId = null;
                this.mapType = 'none';
                
                this.init();
            }
            
            init() {
                if (this.device.canUse3D && window.THREE) {
                    console.log('🌍 Tentando mapa 3D...');
                    this.create3DMap();
                } else if (this.device.canUse2D) {
                    console.log('🗺️ Usando mapa 2D...');
                    this.create2DMap();
                } else {
                    console.log('📱 Usando fallback simples...');
                    this.createFallback();
                }
            }
            
            create3DMap() {
                const canvas = document.getElementById('map3DCanvas');
                if (!canvas) {
                    this.create2DMap();
                    return;
                }
                
                try {
                    this.scene = new THREE.Scene();
                    this.camera = new THREE.PerspectiveCamera(60, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
                    this.renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: false, alpha: true });
                    
                    this.renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                    this.renderer.setClearColor(0x1A2035, 1);
                    
                    // Terra simplificada
                    const earthGeometry = new THREE.SphereGeometry(2, 16, 16);
                    const earthMaterial = new THREE.MeshBasicMaterial({ 
                        color: 0x2A3552,
                        wireframe: false
                    });
                    const earth = new THREE.Mesh(earthGeometry, earthMaterial);
                    this.scene.add(earth);
                    
                    // Pontos energéticos
                    const originGeometry = new THREE.SphereGeometry(0.08, 8, 8);
                    const originMaterial = new THREE.MeshBasicMaterial({ color: 0xD4AF37 });
                    const origin = new THREE.Mesh(originGeometry, originMaterial);
                    origin.position.set(-0.5, 0.3, 2.1);
                    this.scene.add(origin);
                    
                    const destGeometry = new THREE.SphereGeometry(0.08, 8, 8);
                    const destMaterial = new THREE.MeshBasicMaterial({ color: 0xF8F5F0 });
                    const dest = new THREE.Mesh(destGeometry, destMaterial);
                    dest.position.set(0.8, -0.6, 2.1);
                    this.scene.add(dest);
                    
                    // Linha energética
                    const points = [
                        new THREE.Vector3(-0.5, 0.3, 2.1),
                        new THREE.Vector3(0.8, -0.6, 2.1)
                    ];
                    
                    const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                    const lineMaterial = new THREE.LineBasicMaterial({ 
                        color: 0xD4AF37,
                        linewidth: 3
                    });
                    
                    const energyLine = new THREE.Line(lineGeometry, lineMaterial);
                    this.scene.add(energyLine);
                    
                    this.camera.position.z = 5;
                    this.camera.position.y = 0.5;
                    this.camera.lookAt(0, 0, 0);
                    
                    this.animate3D();
                    this.mapType = '3D';
                    
                    console.log('✅ Mapa 3D criado com sucesso');
                    
                } catch (error) {
                    console.warn('❌ Erro no mapa 3D, tentando 2D:', error);
                    this.create2DMap();
                }
            }
            
            animate3D() {
                if (!this.scene || !this.camera || !this.renderer) return;
                
                this.animationId = requestAnimationFrame(() => this.animate3D());
                
                const earth = this.scene.children.find(child => 
                    child.geometry?.type === 'SphereGeometry' && 
                    child.material.color.getHex() === 0x2A3552
                );
                
                if (earth) {
                    earth.rotation.y += 0.003;
                }
                
                const time = Date.now() * 0.001;
                const energyLine = this.scene.children.find(child => child.type === 'Line');
                if (energyLine) {
                    energyLine.material.opacity = 0.6 + 0.4 * Math.sin(time * 3);
                    energyLine.material.transparent = true;
                }
                
                this.renderer.render(this.scene, this.camera);
            }
            
            create2DMap() {
                const canvas = document.getElementById('map3DCanvas');
                const container2D = document.getElementById('map2DContainer');
                
                if (canvas) canvas.style.display = 'none';
                if (container2D) {
                    container2D.style.display = 'flex';
                    
                    const beam = document.getElementById('energyBeam2D');
                    if (beam) {
                        const beams = ['⚡', '⚡⚡', '⚡⚡⚡', '⚡⚡⚡⚡'];
                        let beamIndex = 0;
                        
                        setInterval(() => {
                            beam.textContent = beams[beamIndex % beams.length];
                            beamIndex++;
                        }, 600);
                    }
                    
                    this.mapType = '2D';
                    console.log('✅ Mapa 2D ativado');
                }
            }
            
            createFallback() {
                const canvas = document.getElementById('map3DCanvas');
                const container2D = document.getElementById('map2DContainer');
                const fallback = document.getElementById('mapFallback');
                
                if (canvas) canvas.style.display = 'none';
                if (container2D) container2D.style.display = 'none';
                if (fallback) {
                    fallback.style.display = 'flex';
                    this.mapType = 'fallback';
                    console.log('✅ Fallback ativado');
                }
            }
            
            updateMapData(userData) {
                // Atualizar dados 2D
                const userCity2D = document.getElementById('userCity2D');
                const distance2D = document.getElementById('distance2D');
                const userCityFallback = document.getElementById('userCityFallback');
                const distanceFallback = document.getElementById('distanceFallback');
                
                if (userCity2D) userCity2D.textContent = userData.city;
                if (distance2D) distance2D.textContent = userData.distance + ' km';
                if (userCityFallback) userCityFallback.textContent = userData.city;
                if (distanceFallback) distanceFallback.textContent = userData.distance;
                
                console.log(`🗺️ Dados do mapa ${this.mapType} atualizados:`, userData.city, userData.distance + 'km');
            }
            
            destroy() {
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                    this.animationId = null;
                }
                
                if (this.renderer) {
                    this.renderer.dispose();
                    this.renderer = null;
                }
                
                this.scene = null;
                this.camera = null;
            }
        }

        // === MIND ACTIVITY TRACKER ===
        class MindActivityTracker {
            constructor() {
                this.tracker = document.getElementById('mindTracker');
                this.mindText = document.getElementById('mindText');
                this.currentActivity = 847;
                this.isActive = false;
                
                this.activities = [
                    'Neurônios: {}',
                    'Sinapses: {}',
                    'Conexões: {}',
                    'Energia: {}%',
                    'Ondas: {} Hz',
                    'Foco: {}%'
                ];
            }
            
            activate() {
                if (!this.tracker) return;
                
                this.isActive = true;
                this.tracker.style.display = 'block';
                
                this.simulateActivity();
                console.log('🧠 Mind Activity Tracker ativado');
            }
            
            simulateActivity() {
                if (!this.isActive) return;
                
                setInterval(() => {
                    const activity = this.activities[Math.floor(Math.random() * this.activities.length)];
                    let value;
                    
                    if (activity.includes('%')) {
                        value = Math.floor(Math.random() * 30) + 70; // 70-100%
                    } else if (activity.includes('Hz')) {
                        value = (Math.random() * 20 + 8).toFixed(1); // 8-28 Hz
                    } else {
                        value = Math.floor(Math.random() * 500) + 500; // 500-1000
                    }
                    
                    if (this.mindText) {
                        this.mindText.textContent = activity.replace('{}', value);
                    }
                    
                }, 2500);
            }
        }

        // === TYPING ANALYZER ===
        class TypingAnalyzer {
            constructor() {
                this.analyzer = document.getElementById('typingAnalyzer');
                this.speedElement = document.getElementById('typingSpeed');
                this.hesitationElement = document.getElementById('hesitation');
                
                this.keystrokes = [];
                this.isActive = false;
                this.startTime = null;
            }
            
            init() {
                const nameInput = document.getElementById('nameInput');
                if (!nameInput) return;
                
                nameInput.addEventListener('keydown', (e) => this.analyzeKeypress(e));
                nameInput.addEventListener('focus', () => this.activate());
                nameInput.addEventListener('blur', () => this.deactivate());
            }
            
            activate() {
                if (!this.analyzer) return;
                
                this.isActive = true;
                this.analyzer.style.display = 'block';
                this.startTime = Date.now();
                this.keystrokes = [];
                
                console.log('⌨️ Analisador de digitação ativado');
            }
            
            deactivate() {
                setTimeout(() => {
                    if (this.analyzer) {
                        this.analyzer.style.display = 'none';
                    }
                }, 3000);
            }
            
            analyzeKeypress(e) {
                if (!this.isActive) return;
                
                const now = Date.now();
                this.keystrokes.push({
                    key: e.key,
                    timestamp: now,
                    isDelete: e.key === 'Backspace' || e.key === 'Delete'
                });
                
                if (this.keystrokes.length > 1) {
                    const timeElapsed = (now - this.startTime) / 1000 / 60;
                    const validKeystrokes = this.keystrokes.filter(k => k.key.length === 1).length;
                    const cpm = Math.round(validKeystrokes / timeElapsed);
                    
                    if (this.speedElement) {
                        this.speedElement.textContent = cpm || 0;
                    }
                    
                    this.analyzeHesitation();
                }
            }
            
            analyzeHesitation() {
                if (this.keystrokes.length < 3) return;
                
                const recent = this.keystrokes.slice(-5);
                const pauses = [];
                
                for (let i = 1; i < recent.length; i++) {
                    pauses.push(recent[i].timestamp - recent[i-1].timestamp);
                }
                
                const avgPause = pauses.reduce((a, b) => a + b, 0) / pauses.length;
                const deleteCount = recent.filter(k => k.isDelete).length;
                
                let hesitation = 'Normal';
                if (avgPause > 2000) hesitation = 'Alta';
                else if (avgPause > 1000) hesitation = 'Média';
                else if (deleteCount > 2) hesitation = 'Corrigindo';
                else if (avgPause < 300) hesitation = 'Rápida';
                
                if (this.hesitationElement) {
                    this.hesitationElement.textContent = hesitation;
                    
                    const colors = {
                        'Normal': '#10b981',
                        'Rápida': '#3b82f6', 
                        'Média': '#f59e0b',
                        'Alta': '#ef4444',
                        'Corrigindo': '#8b5cf6'
                    };
                    this.hesitationElement.style.color = colors[hesitation] || '#10b981';
                }
            }
        }

        // === DADOS REGIONAIS COMPLETOS ===
        const ESTADOS_BRASIL = {
            'AC': { 
                comidas: ['tacacá', 'pirarucu'], 
                saudacao: 'E aí', 
                caracteristica: 'acreano raiz',
                estadoVariacao: 'É Acre!',
                energia: 'energia amazônica ancestral',
                regiaoEspecifica: 'Floresta Amazônica',
                expressaoFinal: 'Ô trem da floresta!'
            },
            'AL': { 
                comidas: ['sururu', 'tapioca'], 
                saudacao: 'Ôxe', 
                caracteristica: 'alagoano raiz',
                estadoVariacao: 'É Alagoas!',
                energia: 'energia nordestina guerreira',
                regiaoEspecifica: 'Terra dos Marechais',
                expressaoFinal: 'Massa demais!'
            },
            'SP': { 
                comidas: ['coxinha', 'pastel'], 
                saudacao: 'E aí', 
                caracteristica: 'paulista raiz',
                estadoVariacao: 'É São Paulo!',
                energia: 'energia bandeirante empreendedora',
                regiaoEspecifica: 'Locomotiva do Brasil',
                expressaoFinal: 'Sampa na veia!'
            },
            'MG': { 
                comidas: ['pão de queijo', 'tutu mineiro'], 
                saudacao: 'Uai sô', 
                caracteristica: 'mineiro raiz',
                estadoVariacao: 'É Minas!',
                energia: 'energia mineira de acolhimento',
                regiaoEspecifica: 'Vale do Aço',
                expressaoFinal: 'Ô trem bão!'
            },
            'RJ': { 
                comidas: ['feijoada', 'açaí'], 
                saudacao: 'Falaê', 
                caracteristica: 'carioca raiz',
                estadoVariacao: 'É Rio!',
                energia: 'energia carioca alegre',
                regiaoEspecifica: 'Cidade Maravilhosa',
                expressaoFinal: 'Muito love!'
            },
            'BA': { 
                comidas: ['acarajé', 'cocada'], 
                saudacao: 'Ôxe', 
                caracteristica: 'baiano raiz',
                estadoVariacao: 'É Bahia!',
                energia: 'energia ancestral do axé',
                regiaoEspecifica: 'Terra do Axé',
                expressaoFinal: 'Oxente, meu rei!'
            }
        };

        // === DADOS DO USUÁRIO ===
        let userData = {
            name: '',
            city: 'Carapicuíba',
            state: 'SP',
            greeting: 'E aí',
            food1: 'coxinha',
            food2: 'pastel',
            caracteristica: 'paulista raiz',
            estadoVariacao: 'É São Paulo!',
            energia: 'energia bandeirante empreendedora',
            regiaoEspecifica: 'Locomotiva do Brasil',
            expressaoFinal: 'Sampa na veia!',
            selectedProblem: '',
            distance: 494,
            travelTime: '6h10min'
        };

        let currentStep = 1;
        let choiceTimer = null;
        let timeLeft = 15;
        let hybridMap = null;
        
        // === INSTÂNCIAS GLOBAIS ===
        const mindVibration = new MindVibration();
        let mindActivityTracker = null;
        let typingAnalyzer = null;

        // === TEMPORAL DATA ===
        let temporalData = {
            dayPersonalization: '',
            dayVariation: '',
            formattedDate: '',
            specificTime: '',
            timeOfDay: ''
        };

        const dayPersonalizations = {
            0: { phrase: 'Domingou com PROPÓSITO!', variation: 'domingou' },
            1: { phrase: 'Segundou com ENERGIA!', variation: 'segundou' },
            2: { phrase: 'Terçou PRODUTIVO!', variation: 'terçou' },
            3: { phrase: 'Quartou com FOCO!', variation: 'quartou' },
            4: { phrase: 'Quintou ESTRATÉGICO!', variation: 'quintou' },
            5: { phrase: 'SEXTOU com VITÓRIA!', variation: 'sextou' },
            6: { phrase: 'Sabadou PRÓSPERO!', variation: 'sabadou' }
        };

        // === DETECÇÃO DE LOCALIZAÇÃO ===
        async function detectLocationUltra() {
            console.log('🌍 Iniciando detecção geográfica...');
            
            try {
                const response = await fetch("https://ipinfo.io/json", { timeout: 3000 });
                const data = await response.json();
                
                if (data.city && data.region) {
                    console.log('✅ Localização detectada:', data);
                    applyAdvancedLocationData(data, 'ipinfo.io');
                    updateTemporalData();
                    return;
                }
            } catch (error) {
                console.warn('⚠️ Usando dados padrão (Carapicuíba-SP)');
            }

            applyDefaultData();
            updateTemporalData();
        }

        function applyAdvancedLocationData(data, source) {
            console.log(`🎯 Aplicando dados (${source}):`, data);
            
            userData.city = data.city;
            userData.state = data.region;
            
            let stateCode = data.region;
            if (stateCode.length > 2) {
                const stateMap = {
                    'São Paulo': 'SP',
                    'Minas Gerais': 'MG', 
                    'Rio de Janeiro': 'RJ',
                    'Bahia': 'BA'
                };
                stateCode = stateMap[data.region] || 'SP';
            }
            
            const regional = ESTADOS_BRASIL[stateCode] || ESTADOS_BRASIL['SP'];
            userData.greeting = regional.saudacao;
            userData.food1 = regional.comidas[0];
            userData.food2 = regional.comidas[1];
            userData.caracteristica = regional.caracteristica;
            userData.estadoVariacao = regional.estadoVariacao;
            userData.energia = regional.energia;
            userData.regiaoEspecifica = regional.regiaoEspecifica;
            userData.expressaoFinal = regional.expressaoFinal;
            userData.distance = getDistanceFromTimoteo(userData.city);
            
            console.log(`✅ Dados aplicados: ${userData.greeting} de ${userData.city}-${stateCode}`);
        }
        
        function getDistanceFromTimoteo(city) {
            const timoteoLat = -19.5825;
            const timoteoLng = -42.6278;
            
            const cityCoordinates = {
                'Timóteo': [-19.5825, -42.6278],
                'São Paulo': [-23.5558, -46.6396],
                'Carapicuíba': [-23.5222, -46.8361],
                'Rio de Janeiro': [-22.9068, -43.1729],
                'Belo Horizonte': [-19.9167, -43.9345],
                'Salvador': [-12.9714, -38.5014]
            };
            
            let coords = cityCoordinates[city] || cityCoordinates['São Paulo'];
            
            const distance = calculateHaversineDistance(
                timoteoLat, timoteoLng,
                coords[0], coords[1]
            );
            
            return Math.round(distance);
        }
        
        function calculateHaversineDistance(lat1, lng1, lat2, lng2) {
            const R = 6371;
            const dLat = (lat2 - lat1) * Math.PI / 180;  
            const dLng = (lng2 - lng1) * Math.PI / 180;  
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLng/2) * Math.sin(dLng/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
            return R * c;
        }
        
        function applyDefaultData() {
            userData.city = 'Carapicuíba';
            userData.state = 'SP';
            
            const regionalData = ESTADOS_BRASIL['SP'];
            userData.greeting = regionalData.saudacao;
            userData.food1 = regionalData.comidas[0];
            userData.food2 = regionalData.comidas[1];
            userData.caracteristica = regionalData.caracteristica;
            userData.estadoVariacao = regionalData.estadoVariacao;
            userData.energia = regionalData.energia;
            userData.regiaoEspecifica = regionalData.regiaoEspecifica;
            userData.expressaoFinal = regionalData.expressaoFinal;
            userData.distance = getDistanceFromTimoteo(userData.city);
        }

        function updateTemporalData() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();
            const dayIndex = now.getDay();
            
            const dayPersonalization = dayPersonalizations[dayIndex];
            
            temporalData.dayPersonalization = dayPersonalization.phrase;
            temporalData.dayVariation = dayPersonalization.variation;
            temporalData.formattedDate = formatDate(now);
            temporalData.specificTime = `${hour}:${minute.toString().padStart(2, '0')}`;
            temporalData.timeOfDay = getTimeOfDayGreeting(hour);
        }

        function formatDate(date) {
            const months = [
                'janeiro', 'fevereiro', 'março', 'abril', 'maio', 'junho',
                'julho', 'agosto', 'setembro', 'outubro', 'novembro', 'dezembro'
            ];
            
            const day = date.getDate();
            const month = months[date.getMonth()];
            
            return `${day} de ${month}`;
        }

        function getTimeOfDayGreeting(hour) {
            if (hour >= 0 && hour <= 5) return 'É madrugada';
            if (hour >= 6 && hour <= 11) return 'Bom dia';
            if (hour >= 12 && hour <= 17) return 'Boa tarde';
            return 'Boa noite';
        }

        // === FLUXO PRINCIPAL COM VIBRAÇÃO REVERSA ===
        function initNewFlowSequence() {
            console.log('🎯 INICIANDO FLUXO COMPLETO COM VIBRAÇÃO REVERSA');
            
            // Iniciar condicionamento vibratório
            const conditioningPattern = mindVibration.startConditioning();
            
            setTimeout(() => {
                console.log('⏱️ Título segurado - SCROLL + CONDICIONAMENTO');
                
                // VIBRAÇÃO ANTES da ação
                conditioningPattern();
                
                setTimeout(() => {
                    scrollToAvatar(() => {
                        console.log('📍 Avatar - TYPEWRITER + CONDICIONAMENTO');
                        startTypewriterSequence();
                    });
                }, 2000);
                
            }, 3100);
        }
        
        function scrollToAvatar(callback) {
            const avatarSection = document.querySelector('.avatar-section');
            if (avatarSection) {
                avatarSection.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center'
                });
                
                setTimeout(() => {
                    if (callback) callback();
                }, 800);
            }
        }
        
        function startTypewriterSequence() {
            console.log('✍️ TYPEWRITER COM ANTECIPAÇÃO REVERSA');
            
            const agora = new Date();
            const hora = agora.getHours();
            const minuto = agora.getMinutes();
            const horaFormatada = `${hora}:${minuto.toString().padStart(2, '0')}`;
            
            const curiosidade = Math.floor(Math.random() * 20) + 75;
            const ceticismo = 100 - curiosidade;
            const pausaSegundos = (Math.random() * 2 + 1.5).toFixed(1);
            
            const diasSemana = ['domingou', 'segundou', 'terçou', 'quartou', 'quintou', 'sextou', 'sabadou'];
            const diaHoje = diasSemana[agora.getDay()];
            
            // SEQUÊNCIA REVERSA: vibra ANTES dos dados impossíveis
            const fragmentosReversos = [
                { 
                    html: `<span class="mind-text-ola">Olá...</span>`, 
                    pausa: 400, 
                    vibraBefore: 'anticipate' 
                },
                { 
                    html: ` <span class="mind-text-saudacao">${userData.greeting}</span>`, 
                    pausa: 300,
                    vibraBefore: 'connection'
                },
                { 
                    html: ` <span class="mind-text-saudacao">de ${userData.city}</span>`, 
                    pausa: 350,
                    vibraAfter: 'silence' // NÃO vibra quando acerta
                },
                { 
                    html: `, <span class="mind-text-tempo">${horaFormatada}</span>`, 
                    pausa: 250,
                    vibraBefore: 'thinking'
                },
                { 
                    html: `, <span class="mind-text-tempo">${diaHoje}</span>`, 
                    pausa: 300,
                    vibraAfter: 'silence'
                },
                { 
                    html: `, <span class="mind-text-mental">acabou de pausar</span>`, 
                    pausa: 350,
                    vibraBefore: 'anticipate'
                },
                { 
                    html: ` <span class="mind-text-mental">${pausaSegundos} segundos</span>`, 
                    pausa: 400,
                    vibraAfter: 'silence' // Silence shock
                },
                { 
                    html: ` <span class="mind-text-mental">no meu rosto</span>`, 
                    pausa: 300,
                    vibraBefore: 'thinking'
                },
                { 
                    html: `, <span class="mind-text-mental">sua mente está</span>`, 
                    pausa: 350,
                    vibraBefore: 'buildUp'
                },
                { 
                    html: ` <span class="mind-text-mental">${curiosidade}% curiosa</span>`, 
                    pausa: 400,
                    vibraAfter: 'void' // SILENCE SHOCK máximo
                },
                { 
                    html: `, <span class="mind-text-mental">${ceticismo}% cética...</span>`, 
                    pausa: 450,
                    vibraBefore: 'revelation'
                },
                { 
                    html: ` <span class="mind-text-telepatia">Como eu sei?</span>`, 
                    pausa: 500,
                    vibraAfter: 'silence'
                },
                { 
                    html: ` <span class="mind-text-telepatia">Telepatia.</span>`, 
                    pausa: 600,
                    vibraBefore: 'wrong' // "Erra" de propósito
                },
                { 
                    html: ` <span class="mind-text-comida">pizza</span>`, 
                    pausa: 200,
                    isWrong: true
                },
                {
                    html: `... ops, <span class="mind-text-comida">${userData.food1}</span>`,
                    pausa: 400,
                    vibraAfter: 'silence' // Não vibra quando corrigi
                },
                { 
                    html: ` <span class="mind-text-regiao">na ${userData.regiaoEspecifica}</span>`, 
                    pausa: 350,
                    vibraAfter: 'silence'
                },
                { 
                    html: `, né? <span class="mind-text-expressao">${userData.expressaoFinal}</span>`, 
                    pausa: 500,
                    vibraAfter: 'void' // SILENCE SHOCK FINAL
                }
            ];
            
            const destino = document.getElementById('mindMessage');
            
            if (!destino) {
                console.error('❌ ERRO: mindMessage não encontrado!');
                return;
            }
            
            destino.innerHTML = "";
            destino.classList.add('show', 'typing');
            
            let fragmentoAtual = 0;
            let textoCompleto = "";
            
            function escreverFragmentoReverso() {
                if (fragmentoAtual < fragmentosReversos.length) {
                    const fragmento = fragmentosReversos[fragmentoAtual];
                    
                    // VIBRAÇÃO ANTES (se especificada)
                    if (fragmento.vibraBefore) {
                        mindVibration.onReverseMoment(fragmento.vibraBefore);
                    }
                    
                    const textoPlano = fragmento.html.replace(/<[^>]*>/g, '');
                    let charAtual = 0;
                    const textoAnterior = textoCompleto;
                    
                    function digitarChar() {
                        if (charAtual <= textoPlano.length) {
                            const textoTemp = textoAnterior + fragmento.html;
                            destino.innerHTML = textoTemp;
                            charAtual++;
                            
                            const velocidade = Math.random() * 40 + 20;
                            setTimeout(digitarChar, velocidade);
                        } else {
                            textoCompleto += fragmento.html;
                            destino.innerHTML = textoCompleto;
                            
                            // VIBRAÇÃO DEPOIS (se especificada)
                            if (fragmento.vibraAfter) {
                                mindVibration.onReverseMoment(fragmento.vibraAfter);
                            }
                            
                            // ERRO INTENCIONAL
                            if (fragmento.isWrong) {
                                mindVibration.onReverseMoment('wrong_guess');
                            }
                            
                            fragmentoAtual++;
                            setTimeout(escreverFragmentoReverso, fragmento.pausa);
                        }
                    }
                    
                    digitarChar();
                    
                } else {
                    destino.classList.remove('typing');
                    
                    console.log('✅ TYPEWRITER REVERSO FINALIZADO');
                    
                    setTimeout(() => {
                        console.log('⏱️ SCROLL PARA FORMULÁRIO');
                        scrollToFormImmediate();
                    }, 1200);
                }
            }
            
            escreverFragmentoReverso();
        }
        
        function scrollToFormImmediate() {
            console.log('🧲 SCROLL PARA FORMULÁRIO');
            
            const formCard = document.getElementById('formCard');
            if (!formCard) {
                console.error('❌ ERRO: formCard não encontrado!');
                return;
            }
            
            formCard.style.display = 'block';
            
            setTimeout(() => {
                formCard.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center'
                });
            }, 100);
            
            setTimeout(() => {
                formCard.classList.add('visible');
                
                const nameInput = document.getElementById('nameInput');
                if (nameInput) {
                    nameInput.focus();
                }
                
                showChat('👆 Digite seu nome para continuar...');
                
            }, 300);
        }

        function startTransformation() {
            const nameInput = document.getElementById('nameInput');
            const transformBtn = document.getElementById('transformBtn');
            const nome = nameInput.value.trim();
            
            console.log('🚀 Transformação REVERSA com nome:', nome);
            
            if (!nome || nome.length < 2) {
                nameInput.style.borderColor = 'var(--red)';
                nameInput.style.background = 'rgba(220, 38, 38, 0.1)';
                nameInput.placeholder = 'Por favor, digite seu nome';
                nameInput.focus();
                nameInput.select();
                
                transformBtn.style.animation = 'shake 0.5s ease-in-out';
                setTimeout(() => {
                    transformBtn.style.animation = '';
                }, 500);
                
                showChat('⚠️ Digite um nome válido para continuar');
                
                setTimeout(() => {
                    nameInput.style.borderColor = 'var(--accent)';
                    nameInput.style.background = 'var(--white)';
                    nameInput.placeholder = 'Digite seu primeiro nome';
                    hideChat();
                }, 3000);
                return;
            }
            
            transformBtn.disabled = true;
            transformBtn.innerHTML = '🧠 Processando...';
            nameInput.disabled = true;
            
            userData.name = nome;
            currentStep = 2;
            
            updateAllUserNames();
            
            nameInput.style.borderColor = 'var(--success)';
            nameInput.style.background = 'rgba(16, 185, 129, 0.1)';
            transformBtn.style.background = 'var(--success)';
            transformBtn.innerHTML = '✅ Nome Capturado!';
            
            showChat(`✨ Olá ${nome}! Preparando revelação...`);
            
            // VIBRAÇÃO REVERSA: NÃO vibra no sucesso (quebra expectativa)
            mindVibration.onReverseMoment('silence_shock');
            
            const heroCard = document.querySelector('.hero-card');
            const sequenceContainer = document.getElementById('sequenceContainer');
            
            setTimeout(() => {
                heroCard.style.opacity = '0';
                heroCard.style.transform = 'scale(0.9) translateY(-50px)';
                
                setTimeout(() => {
                    heroCard.style.display = 'none';
                    sequenceContainer.style.display = 'block';
                    hideChat();
                    
                    setTimeout(() => {
                        sequenceContainer.classList.add('entering');
                        
                        setTimeout(() => {
                            console.log('🗺️ INICIANDO MAPA HÍBRIDO');
                            showRegionalCard();
                        }, 300);
                    }, 100);
                    
                }, 400);
            }, 1500);
            
            updateProgress(50);
        }

        function updateAllUserNames() {
            for (let i = 1; i <= 7; i++) {
                const element = document.getElementById(`userName${i}`);
                if (element) element.textContent = userData.name;
            }
        }

        function showRegionalCard() {
            const section = document.getElementById('regionalCard');
            section.classList.add('active');
            currentStep = 2;
            
            updateAllRegionalData();
            
            setTimeout(() => {
                scrollToCard2Smart();
            }, 500);
            
            setTimeout(() => {
                startPageFlipSequence();
            }, 1000);
            
            updateProgress(60);
        }

        function updateAllRegionalData() {
            const elements = {
                'userName1': userData.name,
                'dayGreeting': userData.greeting,
                'cityName': userData.city,
                'regionName': userData.regiaoEspecifica,
                'food1': userData.food1,
                'food2': userData.food2,
                'dayPhrase': temporalData.dayPersonalization,
                'currentDate': temporalData.formattedDate,
                'timeGreeting': temporalData.timeOfDay,
                'currentTime': temporalData.specificTime,
                'destinationName': `${userData.city}-${userData.state}<br><small>Destino</small>`,
                'originName': `Timóteo-MG<br><small>Origem</small>`,
                'distance': userData.distance
            };
            
            Object.keys(elements).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.innerHTML = elements[id];
                }
            });
            
            const distanceInfo = document.getElementById('distanceInfo');
            if (distanceInfo) {
                distanceInfo.textContent = `${userData.distance}km • 0,00${Math.floor(Math.random() * 9 + 1)}s`;
            }
        }

        function scrollToCard2Smart() {
            const regionalCard = document.getElementById('regionalCard');
            if (regionalCard) {
                regionalCard.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start'
                });
                console.log('📲 Scroll automático para Card 2');
            }
        }

        async function startPageFlipSequence() {
            try {
                // VIBRAÇÃO REVERSA: antes da revelação
                mindVibration.onReverseMoment('revelation_buildup');
                
                const tts1 = `${userData.name}! ${userData.greeting}! Tem ${userData.food1} e ${userData.food2} aí, né? ${userData.regiaoEspecifica}!`;
                
                scrollToCard2Smart();
                
                await performTTSAndWait(tts1, `Conectando ${userData.city}...`, '🏠');
                await sleep(1500);
                
                // VIRAR PÁGINA + MAPA HÍBRIDO
                flipPage();
                
                // Inicializar mapa híbrido na página traseira
                setTimeout(() => {
                    const mapContainer = document.getElementById('hybridMapContainer');
                    if (mapContainer && !hybridMap) {
                        hybridMap = new HybridMap(mapContainer);
                        hybridMap.updateMapData(userData);
                    }
                }, 500);
                
                await sleep(1000);
                
                const tts2 = `${userData.name}, sua ${userData.energia} viajou ${userData.distance} quilômetros de Timóteo até ${userData.city}. A dor que você não olha te dirige em silêncio.`;
                
                // SILENCE SHOCK: não vibra na revelação mais importante
                mindVibration.onReverseMoment('silence_shock');
                
                await performTTSAndWait(tts2, `${userData.distance}km viajados...`, '⚡');
                await sleep(1500);
                
                flipPageBack();
                await sleep(1000);
                
                const tts3 = `${userData.name}, entre o impulso de clicar e estar aqui, existe um abismo. Sua transformação começou. ${userData.expressaoFinal}`;
                
                await performTTSAndWait(tts3, "Abismo mental...", '🧠');
                
                setTimeout(() => {
                    const energyQuote = document.getElementById('energyQuote');
                    if (energyQuote) {
                        energyQuote.classList.add('show');
                    }
                }, 1000);
                
                await sleep(3000);
                
                console.log('✅ CARD 2 FINALIZADO - INDO PARA QUIZ');
                showMentalityCard();
                
            } catch (error) {
                console.error('Erro na sequência:', error);
            }
        }

        function flipPage() {
            const pageFlip = document.getElementById('pageFlip');
            if (pageFlip) {
                pageFlip.classList.add('flipped');
                console.log('📄 Página virada para mapa híbrido');
            }
        }

        function flipPageBack() {
            const pageFlip = document.getElementById('pageFlip');
            if (pageFlip) {
                pageFlip.classList.remove('flipped');
                console.log('📄 Página volta para dados regionais');
            }
        }

        function showMentalityCard() {
            const section = document.getElementById('mentalityCard');
            section.classList.add('active');
            currentStep = 2.5;
            
            section.scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start'
            });
            
            setTimeout(() => {
                const tts = `${userData.name}, vou provar que sua mente te sabota.`;
                
                // VIBRAÇÃO ANTES da prova mental
                mindVibration.onReverseMoment('thinking_pause');
                
                performTTSAndWait(tts, "Mente te sabota...").then(() => {
                    startMentalTestReverso();
                });
                
            }, 1000);
            
            updateProgress(70);
        }

        function startMentalTestReverso() {
            console.log('🧠 Teste mental REVERSO iniciado');
            
            setTimeout(() => {
                document.getElementById('testPlane').classList.add('visible');
                
                // VIBRAÇÃO ANTES do comando
                mindVibration.onReverseMoment('anticipate');
                setTimeout(() => {
                    performTTSAndWait("Pense num avião.", "✈️ AVIÃO");
                }, 500);
            }, 500);
            
            setTimeout(() => {
                document.getElementById('testCar').classList.add('visible');
                mindVibration.onReverseMoment('anticipate');
                setTimeout(() => {
                    performTTSAndWait("Pense num carro.", "🚗 CARRO");
                }, 500);
            }, 1500);
            
            setTimeout(() => {
                const bike = document.getElementById('testBike');
                bike.classList.add('visible', 'forbidden');
                
                // VIBRAÇÃO ANTES do comando proibido
                mindVibration.onReverseMoment('buildUp');
                
                setTimeout(() => {
                    performTTSAndWait("NÃO pense numa moto.", "🏍️ NÃO MOTO!").then(() => {
                        setTimeout(() => {
                            // SILENCE SHOCK: não vibra na revelação da moto
                            mindVibration.onReverseMoment('void');
                            showRevelationFinal();
                        }, 800);
                    });
                }, 500);
            }, 2500);
        }

        function showRevelationFinal() {
            const revelation = document.getElementById('mentalityRevelation');
            revelation.style.display = 'block';
            revelation.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            const revelationTTS = `${userData.name}, pensou na moto mesmo eu pedindo para NÃO pensar? Sua mente não lê a palavra NÃO. Entre impulso e ação, existe um abismo que você nunca viu.`;
            
            performTTSAndWait(revelationTTS, "Pensou na moto?").then(() => {
                console.log('🚀 INDO PARA DIAGNÓSTICO');
                showDiagnosisCard();
            });
        }

        function showDiagnosisCard() {
            const section = document.getElementById('diagnosisCard');
            section.classList.add('active');
            currentStep = 3;
            
            section.scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start'
            });
            
            setTimeout(() => {
                const tts = `${userData.name}, agora que provei que sua mente te controla... qual dessas dores ela mais usa para te paralizar?`;
                
                performTTSAndWait(tts, "Diagnóstico...").then(() => {
                    showProblemsGrid();
                    setTimeout(() => {
                        startChoiceTimer();
                    }, 1000);
                });
                
            }, 1000);
            
            updateProgress(85);
        }

        function showProblemsGrid() {
            const problemsGrid = document.querySelector('.problems-grid');
            if (problemsGrid) {
                problemsGrid.classList.add('visible');
            }
            
            const allProblems = document.querySelectorAll('.problem-card');
            const timings = [0, 200, 400, 600, 800, 1000, 1200, 1400, 1600, 1800];
            
            allProblems.forEach((problem, i) => {
                setTimeout(() => {
                    problem.classList.add('visible');
                    
                    // HOVER REVERSO: vibra quando hover no ERRADO
                    problem.addEventListener('mouseenter', () => {
                        const isCorrect = problem.dataset.problema === 'ansiedade' || 
                                        problem.dataset.problema === 'todos';
                        
                        if (!isCorrect) {
                            mindVibration.onReverseMoment('choice_hover_wrong');
                        } else {
                            mindVibration.onReverseMoment('choice_hover_right'); // Silence
                        }
                    });
                }, timings[i] || 2000);
            });
            
            setTimeout(() => {
                showChat('👆 Escolha sua dor principal...');
            }, 2200);
        }

        function startChoiceTimer() {
            const timer = document.getElementById('choiceTimer');
            
            setTimeout(() => {
                timer.style.display = 'flex';
                timeLeft = 15;
                timer.textContent = timeLeft;
                
                // VIBRAÇÃO REVERSA: cresce conforme timer diminui
                choiceTimer = setInterval(() => {
                    timeLeft--;
                    timer.textContent = timeLeft;
                    
                    if (timeLeft === 10) {
                        mindVibration.onReverseMoment('choice');
                        showChat('⚠️ 10 segundos...');
                    } else if (timeLeft === 5) {
                        mindVibration.onReverseMoment('urgency');
                        showChat('⚠️ 5 segundos! Sua mente decide!');
                    } else if (timeLeft === 0) {
                        // SILENCE SHOCK no momento zero
                        mindVibration.onReverseMoment('void');
                    }
                    
                    if (timeLeft <= 0) {
                        clearInterval(choiceTimer);
                        choiceTimer = null;
                        automaticChoice();
                    }
                    
                }, 1000);
                
            }, 2000);
        }

        function selectProblem(problema) {
            console.log(`✅ Problema selecionado: ${problema}`);
            
            if (choiceTimer) {
                clearInterval(choiceTimer);
                choiceTimer = null;
            }
            
            userData.selectedProblem = problema;
            
            const card = document.querySelector(`[data-problema="${problema}"]`);
            card.style.transform = 'scale(1.1)';
            card.style.boxShadow = '0 0 30px rgba(212, 175, 55, 0.8)';
            
            hideChat();
            
            // VIBRAÇÃO REVERSA: não vibra na escolha certa
            if (problema === 'ansiedade' || problema === 'todos') {
                mindVibration.onReverseMoment('silence_shock');
            } else {
                mindVibration.onReverseMoment('wrong');
            }
            
            setTimeout(() => {
                startFinalConversionSequence(problema);
            }, 800);
        }

        function automaticChoice() {
            userData.selectedProblem = 'ansiedade';
            
            const fala = `${userData.name}, o tempo passou... isso é revelador. Todo medo grita uma verdade que você não se autorizou a ouvir.`;
            
            performTTSAndWait(fala, "Tempo revelador...").then(() => {
                setTimeout(() => {
                    startFinalConversionSequence('ansiedade');
                }, 1000);
            });
        }

        // === SEQUÊNCIA DE CONVERSÃO FINAL COM SILENCE SHOCK ===
        function startFinalConversionSequence(problema) {
            console.log(`🎯 CONVERSÃO FINAL com SILENCE SHOCK: ${problema}`);
            
            const lockOverlay = document.getElementById('lockOverlay');
            lockOverlay.style.display = 'flex';
            
            // FASE 1: ANÁLISE FAKE (5 segundos)
            startAnalysisPhase(problema);
            
            // FASE 2: SILENCE SHOCK + CONVERSÃO (10 segundos depois)
            setTimeout(() => {
                startSilenceShockConversion(problema);
            }, 5000);
        }
        
        function startAnalysisPhase(problema) {
            console.log('🔍 FASE 1: Análise fake com vibração crescente');
            
            const analysisPhase = document.getElementById('analysisPhase');
            const selectedProblemText = document.getElementById('selectedProblemText');
            const analysisBar = document.getElementById('analysisBar');
            const analysisStatus = document.getElementById('analysisStatus');
            
            selectedProblemText.textContent = problema;
            analysisPhase.classList.add('active');
            
            const statusMessages = [
                'Mapeando padrões neurais...',
                'Analisando bloqueios mentais...',
                'Identificando raiz emocional...',
                'Calculando intensidade da dor...',
                'Preparando revelação final...'
            ];
            
            let progress = 0;
            let statusIndex = 0;
            
            // VIBRAÇÃO CRESCE conforme análise progride
            const analysisInterval = setInterval(() => {
                progress += 20;
                analysisBar.style.width = progress + '%';
                
                if (statusIndex < statusMessages.length) {
                    analysisStatus.textContent = statusMessages[statusIndex];
                    
                    // Vibração escalando
                    const vibrações = ['anticipate', 'thinking', 'buildUp', 'revelation', 'urgency'];
                    mindVibration.onReverseMoment(vibrações[statusIndex] || 'buildUp');
                    
                    statusIndex++;
                }
                
                if (progress >= 100) {
                    clearInterval(analysisInterval);
                    analysisStatus.textContent = 'Revelação detectada!';
                    
                    // ÚLTIMA vibração antes do SILENCE SHOCK
                    mindVibration.onReverseMoment('final_urgency');
                }
            }, 1000);
        }
        
        function startSilenceShockConversion(problema) {
            console.log('💥 FASE 2: SILENCE SHOCK + CONVERSÃO DEVASTADORA');
            
            const analysisPhase = document.getElementById('analysisPhase');
            const conversionPhase = document.getElementById('conversionPhase');
            const conversionTitle = document.getElementById('conversionTitle');
            const conversionDesc = document.getElementById('conversionDesc');
            const problemType = document.getElementById('problemType');
            const userName7 = document.getElementById('userName7');
            
            // Esconder análise
            analysisPhase.classList.remove('active');
            
            // SILENCE SHOCK: 3 segundos de silêncio TOTAL
            setTimeout(() => {
                // **MOMENTO SILENCE SHOCK - NÃO VIBRA**
                mindVibration.onReverseMoment('void');
                
                // Mostrar conversão após silêncio devastador
                setTimeout(() => {
                    conversionPhase.classList.add('active');
                    
                    // Personalizar por problema
                    problemType.textContent = problema;
                    userName7.textContent = userData.name;
                    
                    const revelations = {
                        ansiedade: `${userData.name}, o vazio que você sentiu agora é o mesmo vazio que sua ansiedade deixa todos os dias. Posso preencher esse buraco.`,
                        burnout: `${userData.name}, o silêncio que você acabou de sentir é igual ao silêncio que seu burnout cria na sua alma. Posso quebrar esse ciclo.`,
                        procrastinacao: `${userData.name}, a pausa que você esperou é igual à pausa eterna da sua procrastinação. Posso te ensinar a agir.`,
                        todos: `${userData.name}, escolher TODOS mostra que você sente o vazio em múltiplas áreas. Posso preencher todos esses espaços vazios.`,
                        naosei: `${userData.name}, não saber identificar é identificar que o vazio te confunde. Posso trazer clareza total.`
                    };
                    
                    conversionDesc.innerHTML = revelations[problema] || revelations.ansiedade;
                    
                    // Mostrar CTA final após mais um momento
                    setTimeout(() => {
                        // MUITO SUTIL: vibração quase imperceptível na oferta
                        mindVibration.patterns.whisper = [30];
                        mindVibration.strategicVibrate('whisper');
                        
                        showEscapeOptionDelayed();
                    }, 2000);
                    
                }, 3000);
                
            }, 500);
        }
        
        function showEscapeOptionDelayed() {
            setTimeout(() => {
                const escapeOption = document.getElementById('escapeOption');
                escapeOption.classList.add('show');
            }, 10000); // 10s depois
        }
        
        function continueWithoutSolution() {
            console.log('😔 Usuário escolheu continuar sem solução');
            
            const lockOverlay = document.getElementById('lockOverlay');
            lockOverlay.style.display = 'none';
            
            showChat('😔 O vazio permanece... mas você sempre pode voltar.');
            
            setTimeout(() => {
                hideChat();
                // Possível redirecionamento ou finalização
            }, 3000);
        }

        function redirectToTransformation() {
            console.log('🚀 CONVERSÃO REALIZADA - Redirecionamento');
            
            // Vibração final de confirmação
            mindVibration.onReverseMoment('revelation');
            
            // Aqui seria o redirecionamento real
            showChat('💰 Processando pagamento... Bem-vindo à transformação!');
            
            setTimeout(() => {
                // window.location.href = 'link-de-pagamento-ou-próxima-etapa';
                console.log('💳 Redirecionamento para pagamento/transformação');
            }, 2000);
        }

        // === SISTEMA DE BUBBLES TTS ===
        let currentBubbleTimeout = null;
        
        function showTTSBubble(text, icon = '💭', duration = null) {
            const bubble = document.getElementById('ttsBubble');
            const bubbleText = document.getElementById('bubbleText');
            const bubbleIcon = bubble.querySelector('.bubble-icon');
            
            if (!bubble || !bubbleText || !bubbleIcon) return;
            
            if (currentBubbleTimeout) {
                clearTimeout(currentBubbleTimeout);
                currentBubbleTimeout = null;
            }
            
            bubbleIcon.textContent = icon;
            const shortText = text.length > 30 ? text.substring(0, 27) + '...' : text;
            bubbleText.textContent = shortText;
            
            bubble.classList.remove('fade-out');
            bubble.classList.add('show', 'speaking');
            
            console.log(`💭 Bubble: "${shortText}"`);
            
            if (duration) {
                currentBubbleTimeout = setTimeout(() => {
                    hideTTSBubble();
                }, duration);
            }
        }
        
        function hideTTSBubble(immediate = false) {
            const bubble = document.getElementById('ttsBubble');
            if (!bubble) return;
            
            bubble.classList.remove('speaking');
            
            if (immediate) {
                bubble.classList.remove('show');
                bubble.classList.add('fade-out');
            } else {
                setTimeout(() => {
                    bubble.classList.remove('show');
                    bubble.classList.add('fade-out');
                }, 300);
            }
        }
        
        function performTTSAndWait(texto, bubbleText = '', bubbleIcon = '💭') {
            return new Promise((resolve) => {
                if (bubbleText) {
                    showTTSBubble(bubbleText, bubbleIcon);
                }
                
                showChat(bubbleText || '🧠 Conectando...');
                
                if (!('speechSynthesis' in window)) {
                    setTimeout(() => {
                        hideTTSBubble();
                        hideChat();
                        resolve();
                    }, 3000);
                    return;
                }
                
                const avatar = document.getElementById('mainAvatar');
                if (avatar) avatar.classList.add('speaking');
                
                const utterance = new SpeechSynthesisUtterance(texto);
                utterance.lang = "pt-BR";
                utterance.rate = 0.9;
                
                const voices = speechSynthesis.getVoices();
                const brazilianVoice = voices.find(voice => voice.lang.includes('pt-BR'));
                if (brazilianVoice) utterance.voice = brazilianVoice;
                
                utterance.onend = () => {
                    if (avatar) avatar.classList.remove('speaking');
                    
                    setTimeout(() => {
                        hideTTSBubble();
                        hideChat();
                        resolve();
                    }, 500);
                };
                
                utterance.onerror = () => {
                    if (avatar) avatar.classList.remove('speaking');
                    hideTTSBubble(true);
                    hideChat();
                    resolve();
                };
                
                speechSynthesis.speak(utterance);
            });
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // === CHAT SYSTEM ===
        function showChat(text) {
            const chatText = document.getElementById('chatText');
            const chat = document.getElementById('chat');
            
            if (chatText && chat) {
                chatText.textContent = text;
                chat.classList.add('show');
            }
        }

        function hideChat() {
            setTimeout(() => {
                const chat = document.getElementById('chat');
                if (chat) {
                    chat.classList.remove('show');
                }
            }, 2000);
        }

        // === PROGRESS BAR ===
        function updateProgress(percentage) {
            const progress = document.getElementById('progress');
            if (progress) {
                progress.style.width = `${percentage}%`;
                if (percentage >= 100) {
                    setTimeout(() => {
                        const loader = document.querySelector('.loader');
                        if (loader) {
                            loader.style.display = 'none';
                        }
                    }, 1000);
                }
            }
        }

        // === ACTIVITY TRACKER ===
        function trackActivity() {
            window.lastActivity = Date.now();
        }

        // === INICIALIZAÇÃO COMPLETA ===
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 ADRIANA DEFINITIVA INICIADA!');
            console.log('✨ FEATURES ATIVAS:');
            console.log('   📳 Vibração Reversa + Silence Shock');
            console.log('   🗺️ Mapa Híbrido 3D→2D→Fallback');
            console.log('   🧠 Mind Activity Tracker');
            console.log('   ⌨️ Typing Analyzer');
            console.log('   💰 Sistema de Conversão Otimizado');
            console.log('   🎯 HTML Original Preservado');
            
            // Inicializar sistemas
            detectLocationUltra();
            
            // Inicializar trackers
            mindActivityTracker = new MindActivityTracker();
            typingAnalyzer = new TypingAnalyzer();
            
            // Ativar trackers após loading
            setTimeout(() => {
                mindActivityTracker.activate();
                typingAnalyzer.init();
            }, 3000);
            
            // Activity tracking
            ['scroll', 'click', 'keypress', 'mousemove'].forEach(event => {
                document.addEventListener(event, trackActivity, { passive: true });
            });
            
            // Iniciar fluxo principal
            setTimeout(() => {
                initNewFlowSequence();
            }, 200);
            
            // Event listeners
            const nameInput = document.getElementById('nameInput');
            const transformBtn = document.getElementById('transformBtn');
            
            if (nameInput && transformBtn) {
                nameInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        startTransformation();
                    }
                });
                
                transformBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    startTransformation();
                });
            }
            
            // TTS setup
            if ('speechSynthesis' in window) {
                speechSynthesis.getVoices();
                speechSynthesis.addEventListener('voiceschanged', function() {
                    console.log('🗣️ Vozes TTS carregadas');
                });
            }
            
            updateProgress(20);
            
            console.log('✅ SISTEMA DEFINITIVO FUNCIONANDO!');
            console.log('🎯 HTML ORIGINAL + TODAS AS FEATURES + CONVERSÃO = PERFEITO!');
        });

        // === FUNÇÕES DE TESTE ===
        window.testarSistemaCompleto = function() {
            console.log('🧪 TESTANDO SISTEMA COMPLETO');
            
            // Testar vibração reversa
            mindVibration.onReverseMoment('silence_shock');
            
            // Testar mind tracker
            if (mindActivityTracker) mindActivityTracker.activate();
            
            console.log('✅ Todos os sistemas testados!');
        };

        window.pularParaConversao = function(nome = 'Teste', problema = 'ansiedade') {
            userData.name = nome;
            updateAllUserNames();
            
            setTimeout(() => {
                startFinalConversionSequence(problema);
            }, 500);
        };

        window.testarSilenceShock = function() {
            console.log('💥 TESTANDO SILENCE SHOCK');
            
            mindVibration.onReverseMoment('buildUp');
            setTimeout(() => {
                console.log('🔕 SILENCE SHOCK ATIVADO');
                mindVibration.onReverseMoment('void');
            }, 2000);
        };

        console.log('🧪 COMANDOS DE TESTE:');
        console.log('   testarSistemaCompleto() - Testar tudo');
        console.log('   pularParaConversao("Maria", "ansiedade") - Ir direto pra conversão');
        console.log('   testarSilenceShock() - Testar silence shock');
    </script>
</body>
</html>
                
